<div class="content-heading">
  <em class="fa fa-book"></em> 提货单
  <div class="pull-right">
    <button *ngIf="isshowzhibaoshu" type="button" (click)="makezhibaoshu()" class="btn btn-info btn-sm margin-top-bottom-25">生成质保书</button>
    <!-- <button type="button" (click)="confirmFee()" class="btn btn-info btn-sm margin-top-bottom-25">确认费用</button> -->
    <button type="button" (click)="showupdatemanyFee()" class="btn btn-info btn-sm margin-top-bottom-25">批量修改费用</button>
    <button *ngIf="showflag.isShowInterestAdd" type="button" (click)="showInterestAdd()"
      class="btn btn-info btn-sm margin-top-bottom-25">资金占用利息登记</button>
    <!-- <button type="button" (click)="showUpdateFeeModal()" class="btn btn-info btn-sm margin-top-bottom-25">修改费用</button> -->
    <!-- <button *ngIf="!tihuo.interestisv" type="button" (click)="fundInterestSubmit()"
      class="btn btn-info btn-sm margin-top-bottom-25">资金占用利息申请</button> -->
    <span *NgOpera="187">
      <button *ngIf="showflag.shiti" type="button" (click)="finishtihuo()"
        class="btn btn-info btn-sm margin-top-bottom-25">实提
      </button>
    </span>
    <div class="btn-group" dropdown>
      <button type="button" tooltip="下载模板请点击右边箭头" placement="bottom" class="btn btn-info btn-sm margin-top-bottom-25" (click)="uploadcarnum()">匹配车号</button>
      <button id="button-split" type="button" dropdownToggle class="btn btn-info btn-sm dropdown-toggle dropdown-toggle-split"
              aria-controls="dropdown-split">
        <span class="caret"></span>
      </button>
      <ul id="dropdown-split" *dropdownMenu class="dropdown-menu"
          role="menu" aria-labelledby="button-split">
        <li role="menuitem"><a class="dropdown-item" href="https://ossgm.oss-cn-hangzhou.aliyuncs.com/pub/gm/down/匹配车号.xls">下载模板</a>
        </li>
      </ul>
    </div>
    <button *ngIf="isshowgodingjin" type="button" (click)="godingjin()"
      class="btn btn-info btn-sm margin-top-bottom-25">去释放定金</button>
    <button type="button" (click)="modifytihuoren()" class="btn btn-sm margin-top-bottom-25"
      style="background-color:red;border-color:red;color:#ffffff;">修改提货人
    </button>
    <!-- <button type="button" (click)="selectall()" class="btn btn-info btn-sm margin-top-bottom-25">全选</button> -->
    <button type="button" (click)="xiaoshoutuihuo()" class="btn btn-sm margin-top-bottom-25"
      style="background-color:red;border-color:red;color:#ffffff;">销售退货
    </button>
    <button *ngIf="showflag.pay" type="button" (click)="paytihuoDialog()"
      class="btn btn-info btn-sm margin-top-bottom-25">付款
    </button>
    <button *ngIf="iscxqk" type="button" (click)="chexiaoqiankuan()"
      class="btn btn-info btn-sm margin-top-bottom-25">撤销欠款
    </button>
    <!-- <button *ngIf="showflag.arrearspay" type="button" (click)="arrearspay()" class="btn btn-info btn-sm margin-top-bottom-25">欠款支付
    </button> -->
    <button *ngIf="showflag.returngoods" type="button" (click)="returngoods()"
      class="btn btn-info btn-sm margin-top-bottom-25">退回
    </button>
    <span *NgOpera="532">
      <button type="button" (click)="refusecancel()" class="btn btn-info btn-sm margin-top-bottom-25">不予撤销提单
      </button>
    </span>
    <button type="button" (click)="addFeeDialog()" class="btn btn-info btn-sm margin-top-bottom-25">添加费用
    </button>
    <button type="button" (click)="addchukuFeeDialog()" class="btn btn-info btn-sm margin-top-bottom-25">出库费用
    </button>
    <button *ngIf="showflag.print && tihuo.interestisv" type="button" (click)="print()"
      class="btn btn-info btn-sm margin-top-bottom-25">打印预览
    </button>
    <button *ngIf="showflag.print" type="button" (click)="reload()"
      class="btn btn-info btn-sm margin-top-bottom-25">生成PDF
    </button>
    <a *ngIf="showlook" [href]="srchetong" type="button" class="btn btn-info btn-sm margin-top-bottom-25">钉钉查看提单
    </a>
    <span *NgOpera="387">
      <button type="button" (click)="cancelShiti()" class="btn btn-info btn-sm margin-top-bottom-25">撤销实提
      </button>
    </span>
    <button type="button" (click)="chexiaotihuo()" class="btn btn-info btn-sm margin-top-bottom-25">撤销提单
    </button>
    <button type="button" (click)="pingjiawuliu()" class="btn btn-info btn-sm margin-top-bottom-25">物流评价
    </button>
    <button class="btn btn-info btn-bloc" style="background-color:red;border-color:red;color:#ffffff;" type="button"
    (click)="deltihuodetfee()">费用明细批量删除</button>
  </div>
</div>

<div class="panel panel-default wis-auto">
  <div class=" col-lg-3 col-md-6 fieldsetdnn">
    <div class="row">
      <div class="col-md-4 col-xs-6 form-control-static">提单编号:</div>
      <div class="col-md-8 col-xs-6 form-control-static">{{tihuo['billno']}}</div>
    </div>
  </div>
  <div class=" col-lg-3 col-md-6 fieldsetdnn">
    <div class="row">
      <div class="col-md-4 col-xs-6 form-control-static">买方单位:</div>
      <div class="col-md-8 col-xs-6 form-control-static">{{tihuo['buyer']?tihuo['buyer']['name']: ''}}</div>
    </div>
  </div>
  <div class=" col-lg-3 col-md-6 fieldsetdnn">
    <div class="row">
      <div class="col-md-4 col-xs-6 control-label form-control-static">总重量:</div>
      <div class="col-md-8 col-xs-6 form-control-static">
        {{tihuo['tweight']}}吨
      </div>
    </div>
  </div>
  <div class=" col-lg-3 col-md-6 fieldsetdnn">
    <div class="row">
      <div class="col-md-4 col-xs-6 control-label form-control-static">总件数:</div>
      <div class="col-md-8 col-xs-6 form-control-static">
        {{tihuo['tcount']}}件
      </div>
    </div>
  </div>
  <div class=" col-lg-3 col-md-6 fieldsetdnn">
    <div class="row">
      <div class="col-md-4 col-xs-6 control-label form-control-static">司机:</div>
      <div class="col-md-8 col-xs-6 form-control-static">
        {{tihuo['siji']}}
      </div>
    </div>
  </div>
  <div class=" col-lg-3 col-md-6 fieldsetdnn">
    <div class="row">
      <div class="col-md-4 col-xs-6 control-label form-control-static">身份证:</div>
      <div class="col-md-8 col-xs-6 form-control-static">
        {{tihuo['sijiid']}}
      </div>
    </div>
  </div>

  <div class=" col-lg-3 col-md-6 fieldsetdnn">
    <div class="row">
      <div class="col-md-4 col-xs-6 control-label form-control-static">手机号:</div>
      <div class="col-md-8 col-xs-6 form-control-static">
        {{tihuo['sijitel']}}
      </div>
    </div>
  </div>
  <div class=" col-lg-3 col-md-6 fieldsetdnn">
    <div class="row">
      <div class="col-md-4 col-xs-6 control-label form-control-static">车号:</div>
      <div class="col-md-8 col-xs-6 form-control-static">
        {{tihuo['chehao']}}
      </div>
    </div>
  </div>
  <div class=" col-lg-3 col-md-6 fieldsetdnn">
    <div class="row">
      <div class="col-md-4 col-xs-6 control-label form-control-static">提货单类型:</div>
      <div class="col-md-8 col-xs-6 form-control-static">
        {{tihuo['tihuotype'] | tihuotype}}
      </div>
    </div>
  </div>
  <div class=" col-lg-3 col-md-6 fieldsetdnn">
    <div class="row">
      <div class="col-md-4 col-xs-6 control-label form-control-static">创建时间:</div>
      <div class="col-md-8 col-xs-6 form-control-static">
        {{tihuo['cdate']}}
      </div>
    </div>
  </div>
  <div class=" col-lg-3 col-md-6 fieldsetdnn">
    <div class="row">
      <div class="col-md-4 col-xs-6 control-label form-control-static">提货类别:</div>
      <div class="col-md-8 col-xs-6 form-control-static">
        {{tihuo['isonline'] | tihuoleibie}}
      </div>
    </div>
  </div>
  <div class=" col-lg-3 col-md-6 fieldsetdnn">
    <div class="row">
      <div class="col-md-4 col-xs-6 control-label form-control-static">是否打印:</div>
      <div class="col-md-8 col-xs-6 form-control-static">
        {{tihuo['isprint'] |flag}}
      </div>
    </div>
  </div>
  <div class=" col-lg-3 col-md-6 fieldsetdnn">
    <div class="row">
      <div class="col-md-4 col-xs-6 control-label form-control-static">提单状态:</div>
      <div class="col-md-8 col-xs-6 form-control-static">
        {{tihuo['status'] |tihuostatus}}
      </div>
    </div>
  </div>
  <div class=" col-lg-3 col-md-6 fieldsetdnn">
    <div class="row">
      <div class="col-md-4 col-xs-6 control-label form-control-static">货款金额:</div>
      <div class="col-md-8 col-xs-6 form-control-static">
        {{tihuo['tjine'] | number:"1.2-2"}}
      </div>
    </div>
  </div>
  <div class=" col-lg-3 col-md-6 fieldsetdnn">
    <div class="row">
      <div class="col-md-4 col-xs-6 control-label form-control-static">支付方式:</div>
      <div class="col-md-8 col-xs-6 form-control-static">
        {{tihuo | paytype}}
      </div>
    </div>
  </div>
  <div class=" col-lg-3 col-md-6 fieldsetdnn">
    <div class="row">
      <div class="col-md-4 col-xs-6 control-label form-control-static">费用金额:</div>
      <div class="col-md-8 col-xs-6 form-control-static">{{tihuo['feetjine'] | number:"1.2-2"}}</div>
    </div>
  </div>
  <div class=" col-lg-3 col-md-6 fieldsetdnn">
    <div class="row">
      <div class="col-md-4 col-xs-6 control-label form-control-static">欠款审核人:</div>
      <div class="col-md-8 col-xs-6 form-control-static">
        {{tihuo['arrearspeople']?tihuo['arrearspeople']['realname']:''}}</div>
    </div>
  </div>
  <div class=" col-lg-3 col-md-6 fieldsetdnn">
    <div class="row">
      <div class="col-md-4 col-xs-6 control-label form-control-static">制单人:</div>
      <div class="col-md-8 col-xs-6 form-control-static">
        {{tihuo | agentuser}}
      </div>
    </div>
  </div>
  <div class=" col-lg-3 col-md-6 fieldsetdnn">
    <div class="row">
      <div class="col-md-4 col-xs-6 control-label form-control-static">撤销人:</div>
      <div class="col-md-8 col-xs-6 form-control-static">
        {{tihuo['cancelmanname']}}
      </div>
    </div>
  </div>
  <div class=" col-lg-3 col-md-6 fieldsetdnn">
    <div class="row">
      <div class="col-md-4 col-xs-6 control-label form-control-static">备注:</div>
      <div class="col-md-8 col-xs-6 form-control-static" style="padding-top:0;padding-bottom:0;">
        <input type="text" placeholder="请输入备注" [(ngModel)]="tihuo['beizhu']" (blur)="modify(tihuo)"
          class="form-control" />
      </div>
    </div>
  </div>
  <div class=" col-lg-3 col-md-6 fieldsetdnn">
    <div class="row">
      <div class="col-md-4 col-xs-6 control-label form-control-static">货物安全:</div>
      <div class="col-md-8 col-xs-6 form-control-static">
        {{wuliuscore['goodssafe']}}
      </div>
    </div>
  </div>
  <div class=" col-lg-3 col-md-6 fieldsetdnn">
    <div class="row">
      <div class="col-md-4 col-xs-6 control-label form-control-static">赔偿能力:</div>
      <div class="col-md-8 col-xs-6 form-control-static">
        {{wuliuscore['ability']}}
      </div>
    </div>
  </div>
  <div class=" col-lg-3 col-md-6 fieldsetdnn">
    <div class="row">
      <div class="col-md-4 col-xs-6 control-label form-control-static">损坏图片:</div>
      <div class="col-md-8 col-xs-6 form-control-static">
        <a href="{{wuliuscore['url']}}" target="_blank" class="text-center">{{wuliuscore['url']}}</a>
      </div>
    </div>
  </div>
  <div class=" col-lg-3 col-md-6 fieldsetdnn" *ngIf="isshowsjfydw">
    <div class="row">
      <div class="col-md-4 col-xs-6 control-label form-control-static">物流公司:</div>
      <div class="col-md-8 col-xs-6 form-control-static">
        {{tihuo['transcompanyname']}}
      </div>
    </div>
  </div>
  <!-- <div class=" col-lg-3 col-md-6 fieldsetdnn">
    <div class="row">
      <div class="col-md-4 col-xs-6 control-label form-control-static">物流配送:</div>
      <div class="col-md-8 col-xs-6 form-control-static">
        <app-mystar *ngIf="wuliuscore['id']" [starsRating]="wuliuscore['rating']" [width]="'20'" [readonly]="true">
        </app-mystar>
      </div>
    </div>
  </div> -->
  <div class=" col-lg-3 col-md-6 fieldsetdnn">
    <div class="row">
      <div class="col-md-4 col-xs-6 control-label form-control-static">货物安全备注:</div>
      <div class="col-md-8 col-xs-6 form-control-static" [title]="wuliuscore['morebeizhu']">
        {{wuliuscore['morebeizhu']}}
      </div>
    </div>
  </div>
  <div class=" col-lg-3 col-md-6 fieldsetdnn">
    <div class="row">
      <div class="col-md-4 col-xs-6 control-label form-control-static">回执单:</div>
      <div class="col-md-8 col-xs-6 form-control-static">
        <a href="{{tihuo['url']}}" target="_blank" class="text-center">{{tihuo['url']}}</a>
      </div>
    </div>
  </div>
</div>


<p-tabView [style]="{margin:'0 -10px','padding-top': '3px'}">
  <p-tabPanel header="钢卷明细"
    [headerStyle]="{'background-color': '#fff', 'border-color': '#ccc','border-bottom-color': 'rgba(0, 0, 0, 0)','margin-left': '5px'}">
    <ag-grid-angular [ngStyle]="{'height': (settings.bodyHeight - 500)+'px'}" #agGrid
      style="width: calc(100% + 22px);height:100%;margin:0 -11px;margin-top:-5px;" class="ag-blue"
      [gridOptions]="gridOptions">
    </ag-grid-angular>
  </p-tabPanel>
  <p-tabPanel header="临调明细"
    [headerStyle]="{'background-color': '#fff', 'border-color': '#ccc','border-bottom-color': 'rgba(0, 0, 0, 0)','margin-left': '5px'}">
    <ag-grid-angular [ngStyle]="{'height': (settings.bodyHeight - 500)+'px'}" #agGrid
      style="width: calc(100% + 22px);height:100%;margin:0 -11px;margin-top:-5px;" class="ag-blue"
      [gridOptions]="ldgridOptions">
    </ag-grid-angular>
  </p-tabPanel>
  <p-tabPanel *ngIf="isshowsjfydw" header="费用明细"
    [headerStyle]="{'background-color': '#fff', 'border-color': '#ccc',color: '#ddd'}">
    <ag-grid-angular [ngStyle]="{'height': (settings.bodyHeight - 500)+'px'}" #agGrid
      style="width: calc(100% + 22px);height:100%;margin:0 -11px;margin-top:-5px;" class="ag-blue"
      [gridOptions]="feegridOptions">
    </ag-grid-angular>
  </p-tabPanel>
  <p-tabPanel *ngIf="!isshowsjfydw" header="费用明细"
    [headerStyle]="{'background-color': '#fff', 'border-color': '#ccc',color: '#ddd'}">
    <ag-grid-angular [ngStyle]="{'height': (settings.bodyHeight - 500)+'px'}" #agGrid
      style="width: calc(100% + 22px);height:100%;margin:0 -11px;margin-top:-5px;" class="ag-blue"
      [gridOptions]="feegridOptionsforsaleman">
    </ag-grid-angular>
  </p-tabPanel>
  <p-tabPanel header="预估仓储费"
    [headerStyle]="{'background-color': '#fff', 'border-color': '#ccc','border-bottom-color': 'rgba(0, 0, 0, 0)','margin-left': '5px'}">
    <ag-grid-angular [ngStyle]="{'height': (settings.bodyHeight - 500)+'px'}" #agGrid
      style="width: calc(100% + 22px);height:100%;margin:0 -11px;margin-top:-5px;" class="ag-blue"
      [gridOptions]="storagefeegridOptions">
    </ag-grid-angular>
  </p-tabPanel>
</p-tabView>

<div class="panel panel-default wis-auto" *ngIf="showlog">
  <div class="row fieldsetdnn" style="font-weight:bold;">提货信息修改记录</div>
  <div class="row fieldsetdnn" *ngFor="let item of loglist; let i = index;">
    <div class=" form-control-static" style="word-wrap: break-word;">{{i + 1}}、{{item.cuser.realname}}--{{item.cdate}}
      <button type="button" (click)="verifyChange()" class="btn btn-info btn-sm margin-top-bottom-25"
        *ngIf="item.verify===null">审核</button>
      <button type="button" (click)="refuseChange()" class="btn btn-info btn-sm margin-top-bottom-25"
        *ngIf="item.verify===null">拒绝</button>
      <span *ngIf="item.verify!==null" style="padding-left:15px;">{{item.verify?"通过":"拒绝"}}</span>
    </div>
    <div class="row fieldsetdnn">
      <div class="col-lg-3 col-md-6">
        <div class="row">
          <div class="col-md-3 col-xs-6 form-control-static">车号:</div>
          <div class="col-md-9 col-xs-6 form-control-static">{{item['chehao']}}</div>
        </div>
      </div>
      <div class="col-lg-3 col-md-6">
        <div class="row">
          <div class="col-md-3 col-xs-6 form-control-static">司机:</div>
          <div class="col-md-9 col-xs-6 form-control-static">{{item['siji']}}</div>
        </div>
      </div>
      <div class="col-lg-3 col-md-6">
        <div class="row">
          <div class="col-md-3 col-xs-6 form-control-static">电话:</div>
          <div class="col-md-9 col-xs-6 form-control-static">{{item['sijitel']}}</div>
        </div>
      </div>
      <div class="col-lg-3 col-md-6">
        <div class="row">
          <div class="col-md-3 col-xs-6 form-control-static">身份证:</div>
          <div class="col-md-9 col-xs-6 form-control-static">{{item['sijiid']}}</div>
        </div>
      </div>
    </div>
    <div class="row fieldsetdnn">
      <div class="col-lg-3 col-md-6">
        <div class="row">
          <div class="col-md-3 col-xs-6 form-control-static">原车号:</div>
          <div class="col-md-9 col-xs-6 form-control-static">{{item['ochehao']}}</div>
        </div>
      </div>
      <div class="col-lg-3 col-md-6">
        <div class="row">
          <div class="col-md-3 col-xs-6 form-control-static">原司机:</div>
          <div class="col-md-9 col-xs-6 form-control-static">{{item['osiji']}}</div>
        </div>
      </div>
      <div class="col-lg-3 col-md-6">
        <div class="row">
          <div class="col-md-3 col-xs-6 form-control-static">原电话:</div>
          <div class="col-md-9 col-xs-6 form-control-static">{{item['osijitel']}}</div>
        </div>
      </div>
      <div class="col-lg-3 col-md-6">
        <div class="row">
          <div class="col-md-3 col-xs-6 form-control-static">原身份证:</div>
          <div class="col-md-9 col-xs-6 form-control-static">{{item['osijiid']}}</div>
        </div>
      </div>
    </div>
    <div class="row fieldsetdnn">
      <div class="col-md-2 col-xs-4 control-label form-control-static">备注：</div>
      <div class="col-md-10 col-xs-8 form-control-static show-hide" style="word-wrap: break-word;">{{item['beizhu']}}
      </div>
    </div>
  </div>
</div>
<toaster-container></toaster-container>



<!-- 费用添加-->
<div class="modal" bsModal #classicModal="bs-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-xs">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" aria-label="Close" (click)="hideDialog()">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title">费用添加</h4>
      </div>
      <div class="modal-body">
        <div class="panel panel-default">
          <div class="panel-body">
            <!--<form name="create" class="form-horizontal">-->
            <div class="form-group mb fieldsetdnn col-sm-12">
              <label class="col-sm-3 control-label">支付类型</label>
              <div class="col-sm-9">
                <label class="radio-inline c-radio">
                  <input id="inlineradio1" type="radio" name="isdianfu" value="false" [(ngModel)]="fee['isdianfu']" />
                  <span class="fa fa-circle"></span>普通</label>
                <label class="radio-inline c-radio">
                  <input id="inlineradio2" type="radio" name="isdianfu" value="true" [(ngModel)]="fee['isdianfu']" />
                  <span class="fa fa-circle"></span>垫付</label>
              </div>
            </div>
            <div class="form-group mb fieldsetdnn col-sm-12">
              <label class="col-sm-3 control-label">费用类型</label>
              <div class="col-sm-9">
                <p-dropdown [options]="feetype" (onChange)="modifytweight()" [(ngModel)]="fee['type']"
                  placeholder="请选择费用类型" [style]="{'width': '100%'}">
                </p-dropdown>
              </div>
            </div>

            <div class="form-group mb fieldsetdnn col-sm-12" *ngIf="fee['type'] === 1 || fee['type'] === 2 || fee['type'] === 3">
              <label class="col-sm-3 control-label">是否我司承运</label>
              <div class="col-sm-9">
                <label class="radio-inline c-radio">
                  <input id="inlineradio1" type="radio" name="iscarries-radio" [value]="1" [(ngModel)]="fee['iscarries']" />
                  <span class="fa fa-circle"></span>是
                </label>
                <label class="radio-inline c-radio">
                  <input id="inlineradio2" type="radio" name="iscarries-radio" [value]="0" [(ngModel)]="fee['iscarries']" />
                  <span class="fa fa-circle"></span>否
                </label>
              </div>
            </div>
            <div class="form-group mb fieldsetdnn row" *ngIf="fee['iscarries'] === 1">
              <label class="col-sm-3 control-label">起始地址</label>
              <div class="col-sm-9">
                <input type="text" placeholder="请输入详细地址" [(ngModel)]="fee['startaddr']" class="form-control"
                  required (blur)="selecteddes1(fee['startaddr'])" />
              </div>
            </div>
            <div class="form-group mb fieldsetdnn row" *ngIf="fee['iscarries'] === 1">
              <div class="col-sm-4" style="padding-left:15px;">
                <p-dropdown [options]="provinces" [(ngModel)]="fee['sprovinceid']" 
                  [style]="{'width':'100%','font-size':'15px'}" [placeholder]="'请选择省份'" (onChange)="getcity()">
                </p-dropdown>
              </div>
              <div class="col-sm-4" style="padding-left:15px;">
                <p-dropdown [options]="citys" [(ngModel)]="fee['scityid']"
                  [style]="{'width':'100%','font-size':'15px'}" [placeholder]="'请选择市'" (onChange)="getcounty()">
                </p-dropdown>
              </div>
              <div class="col-sm-4" style="padding-left:15px;">
                <p-dropdown [options]="countys" [(ngModel)]="fee['scountyid']"
                  [style]="{'width':'100%','font-size':'15px'}" [placeholder]="'请选择县'">
                </p-dropdown>
              </div>
            </div>
            <div class="form-group mb fieldsetdnn row" *ngIf="fee['iscarries'] === 1">
              <label class="col-sm-3 control-label">目的地址</label>
              <div class="col-sm-9">
                <input type="text" placeholder="请输入详细地址" [(ngModel)]="fee['endaddr']" class="form-control"
                  required (blur)="selecteddes2(fee['endaddr'])" />
              </div>
            </div>
            <div class="form-group mb fieldsetdnn row" *ngIf="fee['iscarries'] === 1">
              <div class="col-sm-4" style="padding-left:15px;">
                <p-dropdown [options]="provinces2" [(ngModel)]="fee['eprovinceid']" 
                  [style]="{'width':'100%','font-size':'15px'}" [placeholder]="'请选择省份'" (onChange)="getcity2()">
                </p-dropdown>
              </div>
              <div class="col-sm-4" style="padding-left:15px;">
                <p-dropdown [options]="citys2" [(ngModel)]="fee['ecityid']"
                  [style]="{'width':'100%','font-size':'15px'}" [placeholder]="'请选择市'" (onChange)="getcounty2()">
                </p-dropdown>
              </div>
              <div class="col-sm-4" style="padding-left:15px;">
                <p-dropdown [options]="countys2" [(ngModel)]="fee['ecountyid']"
                  [style]="{'width':'100%','font-size':'15px'}" [placeholder]="'请选择县'">
                </p-dropdown>
              </div>
            </div>
            <div class="form-group mb fieldsetdnn col-sm-12">
              <label class="col-sm-3 control-label">总重量</label>
              <div class="col-sm-9">
                <input type="text" [(ngModel)]="fee['tweight']" class="form-control" [disabled]="expression" />
              </div>
            </div>
            <!-- <div class="form-group mb fieldsetdnn col-sm-12">
              <label class="col-sm-3 control-label">预估单价</label>
              <div class="col-sm-6">
                <input type="number" [(ngModel)]="fee['yugufeeprice']" class="form-control" disabled />
              </div>
              <div class="col-sm-3">
                <button type="button" (click)="findyugufeeprice()" class="btn btn-primary btn-large">选择</button>
              </div>
            </div> -->
            <div class="form-group mb fieldsetdnn col-sm-12">
              <label class="col-sm-3 control-label">单价</label>
              <div class="col-sm-9">
                <input type="number" [(ngModel)]="fee['price']" class="form-control" (blur)="getjine()" />
              </div>
            </div>
            <div class="form-group mb fieldsetdnn col-sm-12">
              <label class="col-sm-3 control-label">金额</label>
              <div class="col-sm-9">
                <input type="number" [(ngModel)]="fee['jine']" class="form-control" (blur)="getprice()" />
              </div>
            </div>
            <div class="form-group mb fieldsetdnn col-sm-12">
              <label class="col-sm-3 control-label">实付单价：</label>
              <div class="col-sm-9">
                <input type="number" [(ngModel)]="fee['innerprice']" class="form-control" placeholder="请输入实付单价"
                  (blur)="calinnerjine()" />
              </div>
            </div>
            <div class="form-group mb fieldsetdnn col-sm-12">
              <label class="col-sm-3 control-label">实付金额：</label>
              <div class="col-sm-9">
                <input type="number" [(ngModel)]="fee['innerjine']" class="form-control" placeholder="请输入实付金额"
                  (blur)="calinnerprice()" />
              </div>
            </div>
            <div class="form-group mb fieldsetdnn col-sm-12">
              <label class="col-sm-3 control-label">费用单位</label>
              <div class="col-sm-9">
                <wis-feecompanysearch (select)="isyunyingzhongxin()" [(company)]="companyOfProduce">
                </wis-feecompanysearch>
              </div>
            </div>
            <div *ngIf="fee['feecustomerid']==='9545'" class="form-group mb fieldsetdnn col-sm-12">
              <label class="col-sm-3 control-label">实际费用单位</label>
              <div class="col-sm-9">
                <wis-feecompanysearch [(company)]="actualfeecustomer"></wis-feecompanysearch>
              </div>
            </div>
            <div class="form-group mb fieldsetdnn col-sm-12">
              <label class="col-sm-3 control-label">记账方向</label>
              <div class="col-sm-9">
                <!-- <label class="radio-inline c-radio">
                  <input id="radio1" type="radio" name="accountdirection" [value]="1" [(ngModel)]="fee['accountdirection']" />
                  <span class="fa fa-circle"></span>采购</label> -->
                <label class="radio-inline c-radio">
                  <input id="radio2" type="radio" name="accountdirection" [value]="2"
                    [(ngModel)]="fee['accountdirection']" />
                  <span class="fa fa-circle"></span>销售</label>
              </div>
            </div>
            <div class="form-group mb fieldsetdnn col-sm-12">
              <label class="col-sm-3 control-label">备注</label>
              <div class="col-sm-9">
                <input type="text" [(ngModel)]="fee['miaoshu']" class="form-control" />
              </div>
            </div>

            <!--</form>-->
          </div>
        </div>

      </div>
      <div class="modal-footer">
        <div class="form-inline text-center">
          <div class="form-inline text-center">
            <button type="button" (click)="createFee()" class="btn btn-primary btn-large">添加</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- 预估费用列表 -->
<div class="modal" bsModal #yugufeedialog="bs-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <button class="close" type="button" aria-label="Close" (click)="hideyugufeeDialog()">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title pull-left">预估费用选择</h4>
      </div>

      <div class="modal-body">
        <div class="panel panel-default">
          <div class="panel-body">
            <div class="form-group mb fieldsetdnn col-sm-6 col-md-6">
              <label class="col-sm-12 control-label">费用类型</label>
            </div>
            <div class="form-group mb fieldsetdnn col-sm-3 col-md-3">
              <label class="col-sm-12 control-label">单价</label>
            </div>
            <div class="form-group mb fieldsetdnn col-sm-3 col-md-3">
              <label class="col-sm-12 control-label">备注</label>
            </div>
            <div *ngFor="let item of lines" class="col-sm-12">
              <div class="form-group mb fieldsetdnn col-sm-6 col-md-6">
                <input type="radio" name="select" (click)="onselect(item.id)" />
                <span>{{item.feetype|feetype}}</span>
              </div>
              <div class="form-group mb fieldsetdnn col-sm-3 col-md-3">
                <span>{{item.feeprice}}</span>
              </div>
              <div class="form-group mb fieldsetdnn col-sm-3 col-md-3">
                <span>{{item.beizhu}}</span>
              </div>
            </div>

          </div>
        </div>
      </div>
      <div class="modal-footer">
        <div class="form-inline text-center">
          <button type="button" (click)="selectedyugufee()" class="btn btn-primary btn-large">确认</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!--  付款的弹窗 -->
<div class="modal" bsModal #payModal="bs-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-xs">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" aria-label="Close" (click)="hidepayDialog()">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title">付款</h4>
      </div>
      <div class="modal-body">
        <div class="panel panel-default">
          <div class="panel-body">
            <div class="form-group mb fieldsetdnn col-sm-12">
              <label class="col-sm-3 control-label">客户余额：</label>
              <div class="col-sm-9" style="text-align:right;">
                ￥{{sumjine | number:'1.2-2'}}
              </div>
            </div>
            <!-- <div class="form-group mb fieldsetdnn col-sm-12">
              <label class="col-sm-3 control-label">释放定金：</label>
              <div class="col-sm-9" style="text-align:right;">
                ￥{{tihuo['releasejine'] | number:'1.2-2'}}
              </div>
            </div> -->
            <!-- <div class="form-group mb fieldsetdnn col-sm-12">
              <label class="col-sm-3 control-label">释放配款：</label>
              <div class="col-sm-9">
                ￥{{tihuo['releaseallocation'] | number:'1.2-2'}}
              </div>
            </div> -->
            <div class="form-group mb fieldsetdnn col-sm-12">
              <label class="col-sm-3 control-label">应付钱款：</label>
              <div class="col-sm-9" style="text-align:right;">
                ￥{{msg.paymoney | number:'1.2-2'}}
              </div>
            </div>
            <div class="form-group mb fieldsetdnn col-sm-12">
              <label class="col-sm-3 control-label">验证码：</label>
              <div class="col-sm-9">
                <div class="input-group">
                  <input type="text" [(ngModel)]="msg.code" class="form-control" ng-maxlength="6" placeholder="请输入验证码"
                    required />
                  <span class="input-group-btn">
                    <button type="button" class="btn btn-default" (click)="getpaycode()" [disabled]="msg.flag">
                      <i class="fa">{{msg.name}}</i>
                    </button>
                  </span>
                </div>
              </div>
            </div>
          </div>
        </div>

      </div>
      <div class="modal-footer">
        <div class="form-inline text-center">
          <div class="form-inline text-center">
            <button type="button" (click)="tihuopay()" class="btn btn-primary btn-large"
              [disabled]="msg.payflag">付款</button>
            <button type="button" (click)="arrearspayapply()" class="btn btn-primary btn-large"
              [disabled]="msg.arrearsflag">欠款支付申请</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!--  修改的提货人信息的弹窗 -->

<div class="modal" bsModal #peopleModal="bs-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-xs">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" aria-label="Close" (click)="hidepeopleModal()">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title">修改提货人信息</h4>
      </div>
      <form [formGroup]="tihuoForm" class="form-validate mb-lg" role="form" name="loginForm" novalidate=""
        (submit)="submittihuo()">
        <div class="modal-body">
          <div class="panel panel-default">
            <div class="panel-body">
              <div class="form-group mb fieldsetdnn col-sm-12">
                <label class="col-sm-3 control-label">车牌号</label>
                <div class="col-sm-9">
                  <input type="text" formControlName="carnum" [(ngModel)]="params1['carnum']" class="form-control"
                    placeholder="请输入车牌号" />
                </div>
              </div>
              <div class="form-group mb fieldsetdnn col-sm-12">
                <label class="col-sm-3 control-label">司机信息</label>
                <div class="col-sm-9">
                  <input type="text" formControlName="driverinfo" [(ngModel)]="params1['driverinfo']" class="form-control"
                    placeholder="请输入司机信息" />
                </div>
              </div>
              <!-- <div class="form-group mb fieldsetdnn col-sm-12">
                <label class="col-sm-3 control-label">手机号</label>
                <div class="col-sm-9">
                  <div class="input-group">
                    <input type="text" formControlName="sijitel" [(ngModel)]="params1['sijitel']" class="form-control"
                      ng-blur="calcperprice()" placeholder="请输入司机手机号" />
                    <span
                      *ngIf="tihuoForm.controls['sijitel'].hasError('required') && (tihuoForm.controls['sijitel'].dirty || tihuoForm.controls['sijitel'].touched)"
                      class="text-danger">请填写司机手机号</span>
                    <span
                      *ngIf="tihuoForm.controls['sijitel'].hasError('pattern') && (tihuoForm.controls['sijitel'].dirty || tihuoForm.controls['sijitel'].touched)"
                      class="text-danger">司机手机号填写不规范</span>
                  </div>

                </div>
              </div>
              <div class="form-group mb fieldsetdnn col-sm-12">
                <label class="col-sm-3 control-label">身份证</label>
                <div class="col-sm-9">
                  <input type="text" formControlName="sijiid" [(ngModel)]="params1['sijiid']" class="form-control"
                    ng-blur="calcperprice()" placeholder="请输入司机身份证" maxlength="18" minlength="15" />
                  <span
                    *ngIf="tihuoForm.controls['sijiid'].hasError('required') && (tihuoForm.controls['sijiid'].dirty || tihuoForm.controls['sijiid'].touched)"
                    class="text-danger">请填写身份证</span>
                  <span
                    *ngIf="tihuoForm.controls['sijiid'].hasError('pattern') && (tihuoForm.controls['sijiid'].dirty || tihuoForm.controls['sijiid'].touched)"
                    class="text-danger">身份证填写不规范</span>
                </div>
              </div>
              <div class="form-group mb fieldsetdnn col-sm-12">
                <label class="col-sm-3 control-label">备注</label>
                <div class="col-sm-9">
                  <input type="text" formControlName="beizhu" [(ngModel)]="params1['beizhu']" class="form-control"
                    ng-blur="" placeholder="请输入备注" />
                </div>
              </div> -->
              <!-- <div *ngIf="isdaiyun" class="form-group mb fieldsetdnn col-sm-12">
                <label class="col-sm-3 control-label">送货地址</label>
                <div class="col-sm-9">
                  <input type="text" formControlName="shouhuoaddr" [(ngModel)]="params1['shouhuoaddr']"
                    class="form-control" ng-blur="" placeholder="请输入送货地址" />
                  <button type="button" class="btn btn-primary btn-little" [disabled]="">发起审批</button>
                </div>
              </div> -->

            </div>
          </div>

        </div>
        <div class="modal-footer">
          <div class="form-inline text-center">
            <div class="form-inline text-center">
              <button type="submit" class="btn btn-primary btn-large" [disabled]="">提交</button>
            </div>
          </div>
        </div>
      </form>
    </div>
  </div>
</div>
<!--临调提货重量修改-->
<div class="modal" bsModal #weightmodify="bs-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-xs">
    <div class="modal-content">
      <div class="modal-header">
        <button class="close" type="button" aria-label="Close" (click)="closeweightmodifydialog()">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title">重量修改</h4>
      </div>
      <div class="modal-body">
        <div class="panel panel-default">
          <div class="panel-body">

            <div class="form-group mb fieldsetdnn row">
              <label class="col-sm-3 control-label">
                <span style="float: right;">重量：</span>
              </label>
              <div class="col-sm-9">

                <input type="text" [(ngModel)]="weight['weight']" class="form-control" placeholder="请输入要修改的重量"
                  maxlength="18" minlength="15" />

              </div>
            </div>

          </div>
        </div>
      </div>
      <div class="form-inline text-center">
        <button type="button" (click)="modifyldweight()" class="btn btn-primary btn-large">修改</button>
      </div>
    </div>
  </div>
</div>
<!-- 欠款申请 -->
<div class="modal" bsModal #arrearspayDialog="bs-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" aria-label="Close" (click)="arrearspayhide()">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title">欠款申请</h4>
      </div>
      <div class="modal-body">
        <div class="panel panel-default">
          <div class="panel-body">
            <div class="form-group mb fieldsetdnn col-sm-12">
              <label class="col-sm-3 control-label">欠款金额：</label>
              <div class="col-sm-9">
                ￥{{overdraft['tjine']}}
              </div>
            </div>
            <div class="form-group mb fieldsetdnn col-sm-12">
              <label class="col-sm-3 control-label">还款日期：</label>
              <div class="col-sm-9 wiskind-calendar">
                <p-calendar [(ngModel)]="yedate" placeholder="还款日期" [minDate]="minDate"></p-calendar>
              </div>
            </div>
            <div class="form-group mb fieldsetdnn col-sm-12">
              <label class="col-sm-3 control-label">货物名称：</label>
              <div class="col-sm-9">
                <input type="text" class="form-control" [(ngModel)]="overdraft['goodsmsg']" />
              </div>
            </div>
            <div class="form-group mb fieldsetdnn col-sm-12">
              <label class="col-sm-3 control-label">欠款天数：</label>
              <div class="col-sm-9">
                <input type="number" class="form-control" [(ngModel)]="overdraft['days']" />
              </div>
            </div>
            <div class="form-group mb fieldsetdnn col-sm-12">
              <label class="col-sm-3 control-label">欠款原因：</label>
              <div class="col-sm-9">
                <input type="text" class="form-control" [(ngModel)]="overdraft['reason']" />
              </div>
            </div>
            <div class="form-group mb fieldsetdnn col-sm-12">
              <label class="col-sm-3 control-label">欠款类型：</label>
              <div class="col-sm-9">
                <p-dropdown [options]="qiankuantypes"  (onChange)="getbucha($event)" [(ngModel)]="overdraft['qiankuantype']" placeholder="选择欠款类型" [style]="{'width': '100%'}"></p-dropdown>
              </div>
            </div>
            <div *ngIf="shengchengbucha">
              <div class="form-group mb fieldsetdnn row col-md-12" >
               <label class="col-sm-3 control-label"><span style="float: left;">生成补差单：</span></label>
                <div class="col-sm-9">
                 <label class="radio-inline c-radio">
                   <input type="radio" [value]="true" name="buchadan" [(ngModel)]="overdraft['isbucha']"  />
                   <span class="fa fa-circle"></span>是
                 </label>
                 <label class="radio-inline c-radio">
                   <input type="radio" [value]="false" name="buchadan" [(ngModel)]="overdraft['isbucha']"/>
                   <span class="fa fa-circle"></span>否
                 </label>
               </div>
              </div>
             </div>

            <div *ngIf="haszhiyajin" class="form-group mb fieldsetdnn col-sm-12">
              <label class="col-sm-3 control-label">引入质押金总金额：</label>
              <div class="col-sm-9">
                <input disabled  type="text" class="form-control" [(ngModel)]="overdraft['tzhiyajinjine']" />
              </div>
            </div>

            <div *ngIf="haszhiyajin" class="row">
              <div class="col-sm-3 text-center">
                <label class="col-sm-12 control-label form-control-static">质押公司</label>
              </div>
              <div class="col-sm-2 text-center">
                <label class="col-sm-12 control-label form-control-static">质押金金额</label>
              </div>
              <div class="col-sm-2 text-center">
                <label class="col-sm-12 control-label form-control-static">可引用金额</label>
              </div>
              <div class="col-sm-3 text-center">
                <label class="col-sm-12 control-label form-control-static">本次引用金额</label>
              </div>
              <div class="col-sm-2 text-center">
                <label class="col-sm-12 control-label form-control-static">操作</label>
              </div>
            </div>

            <div class="row fieldsetdnn" *ngFor="let item of zhiyajins">
              <div class="col-sm-3 text-center">
                <span>
                  {{item.shoukuancustomer}}
                </span>
              </div>
              <div class="col-sm-2 text-center">
                <span>{{item.jine}}</span>
              </div>
              <div class="col-sm-2 text-center">
                <span>{{item.weiimpjine}}</span>
              </div>

              <div *ngIf="item.isshowzhiyajininput" class="col-sm-3 text-center">
                <span (click)="showeditdialog(item.id)"> <a>填  充</a></span>
              </div>
              <div *ngIf="!item.isshowzhiyajininput" class="col-sm-3 text-center">
                <span>{{item.zhiyajinimpjine}}</span>
              </div>

              <div class="col-sm-2 text-center">
                <span *ngIf="!item.isshowzhiyajininput" style="padding-left: 40px" (click)="modifyzhiyajin(item.id)">
                  <a>修改</a>
                </span>
              </div>
            </div>


          </div>
        </div>
      </div>
      <div class="modal-footer">
        <div class="form-inline text-center">
          <div class="form-inline text-center">
            <button *ngIf="!iszhiyajinapply" type="button" (click)="submitapply()" class="btn btn-info btn-large">提交申请</button>
            <button *ngIf="haszhiyajin" type="button" (click)="zhiyajinapply()" class="btn btn-info btn-large">质押金欠款</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<!--  添加引用质押金额的弹窗 -->
<div class="modal" bsModal #zhiyajinusejineeditor="bs-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-xs">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" aria-label="Close" (click)="closeeditdialog()">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title">引入质押金额</h4>
      </div>
      <div class="modal-body">
        <div class="panel panel-default">
          <div class="panel-body">

            <div class="form-group mb fieldsetdnn col-sm-12">
              <label class="col-sm-3 control-label">质押金引用金额</label>
              <div class="col-sm-9">
                <input type="number"  name="perprice" class="form-control" [(ngModel)] = "zhiyajinimpjine"
                  placeholder="请输入引用金额"  required />
              </div>
            </div>
            
          </div>
        </div>

      </div>
      <div class="modal-footer">
        <div class="form-inline text-center">
          <div class="form-inline text-center">
            <button type="button" (click)="usezhiyajin()" class="btn btn-primary btn-large">添加</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<!--出库费用添加弹窗-->
<div class="modal" bsModal #chukufeedialog="bs-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" aria-label="Close" (click)="hidechukuDialog()">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title">添加出库费用</h4>
      </div>
      <div class="modal-body">
        <div class="panel panel-default">
          <div class="panel-body">

            <div class="form-group mb fieldsetdnn col-sm-6">
              <label class="col-sm-4 control-label">费用单位:</label>
              <div class="col-sm-8">
                <wis-feecompanysearch [(company)]="companyOfProduce"></wis-feecompanysearch>
              </div>
            </div>
            <div class="form-group mb fieldsetdnn col-sm-6">
              <label class="col-sm-4 control-label">备注:</label>
              <div class="col-sm-8" style="padding-top:1px;padding-bottom:1px;">
                <input type="text" [(ngModel)]="fee['miaoshu']" class="form-control" required />
              </div>
            </div>

          </div>
        </div>
        <div class="form-inline text-center">
          <button type="button" (click)="createchukuFee()" class="btn btn-primary btn-large">添加</button>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="modal" bsModal #uploadcarnumModal="bs-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
aria-hidden="false">
  <div class="modal-dialog modal-xs">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" aria-label="Close" (click)="hideuploadcarnumDialog()">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title">上传队列</h4>
      </div>
      <wisk-uploader [uploadParam]="uploadcarnumParam" [accept]="acceptcarnum" (select)="uploadscarnum($event)"></wisk-uploader>
      <div class="form-inline">
      </div>
    </div>
  </div>
</div>
<!-- 销售退货弹窗 -->
<div class="modal" bsModal #xiaoshoutuihuodialog="bs-modal" tabindex="-1" role="dialog"
  aria-labelledby="mySmallModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-xs">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" aria-label="Close" (click)="hidexiaoshoutuihuoDialog()">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title">添加销售退货备注</h4>
      </div>
      <div class="modal-body">
        <div class="panel panel-default">
          <div class="panel-body">
            <div class="form-group mb fieldsetdnn col-sm-12">
              <label class="col-sm-3 control-label">备注</label>
              <div class="col-sm-9">
                <input type="text" [(ngModel)]="beizhu" class="form-control" />
              </div>
            </div>
            <span class="col-sm-3" style="color: red;">*退货备注必填</span>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <div class="form-inline text-center">
          <div class="form-inline text-center">
            <button type="button" (click)="xstuihuo()" class="btn btn-primary btn-large">添加</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- 物流评价弹窗 -->
<div class="modal" bsModal #pingjiawuliumodal="bs-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" aria-label="Close" (click)="hidepingjiawuliu()">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title">货物安全及赔偿能力评价<span style="color:red;font-size: 14px;">（多次评价以最后一次评价为准）</span></h4>
      </div>
      <div class="modal-body">
        <div class="panel panel-default">
          <div class="panel-body">
            <div class="form-group mb fieldsetdnn col-sm-12 row-flex flex-aligns" style="padding:0;float: none;">
              <label class="col-sm-2 control-label" style="padding:0;float: none;">一、货物安全</label>
              <div class="col-sm-10">
                <div class="row col-sm-12 row-flex flex-aligns" style="padding:0;float: none;">
                  <label class="col-sm-9 control-label form-control-static"
                    style="white-space: normal;">1、仓库提货检查货物是否完好。</label>
                  <div class="col-sm-3">
                    <label class="radio-inline c-radio">
                      <input id="goodssafe1" type="radio" [value]="5" name="goodssafe1"
                        [(ngModel)]="ratingobj['goodssafe1']" />
                      <span class="fa fa-circle"></span>是
                    </label>
                    <label class="radio-inline c-radio">
                      <input id="goodssafe1" type="radio" [value]="0" name="goodssafe1"
                        [(ngModel)]="ratingobj['goodssafe1']" />
                      <span class="fa fa-circle"></span>否
                    </label>
                  </div>
                </div>
                <div class="row col-sm-12 row-flex flex-aligns" style="padding:0;float: none;">
                  <label class="col-sm-9 control-label form-control-static"
                    style="white-space: normal;">2、卸货现场穿着仪表端正，按顺序排队。</label>
                  <div class="col-sm-3">
                    <label class="radio-inline c-radio">
                      <input id="goodssafe2" type="radio" [value]="5" name="goodssafe2"
                        [(ngModel)]="ratingobj['goodssafe2']" />
                      <span class="fa fa-circle"></span>是
                    </label>
                    <label class="radio-inline c-radio">
                      <input id="goodssafe2" type="radio" [value]="0" name="goodssafe2"
                        [(ngModel)]="ratingobj['goodssafe2']" />
                      <span class="fa fa-circle"></span>否
                    </label>
                  </div>
                </div>
                <div class="row col-sm-12 row-flex flex-aligns" style="padding:0;float: none;">
                  <label class="col-sm-9 control-label form-control-static"
                    style="white-space: normal;">3、能很好的配合客户现场工作，零投诉。</label>
                  <div class="col-sm-3">
                    <label class="radio-inline c-radio">
                      <input id="goodssafe3" type="radio" [value]="10" name="goodssafe3"
                        [(ngModel)]="ratingobj['goodssafe3']" />
                      <span class="fa fa-circle"></span>是
                    </label>
                    <label class="radio-inline c-radio">
                      <input id="goodssafe3" type="radio" [value]="0" name="goodssafe3"
                        [(ngModel)]="ratingobj['goodssafe3']" />
                      <span class="fa fa-circle"></span>否
                    </label>
                  </div>
                </div>
                <div class="row col-sm-12 row-flex flex-aligns" style="padding:0;float: none;">
                  <label class="col-sm-9 control-label form-control-static"
                    style="white-space: normal;">4、按时完成送货。</label>
                  <div class="col-sm-3">
                    <label class="radio-inline c-radio">
                      <input id="goodssafe4" type="radio" [value]="5" name="goodssafe4"
                        [(ngModel)]="ratingobj['goodssafe4']" />
                      <span class="fa fa-circle"></span>是
                    </label>
                    <label class="radio-inline c-radio">
                      <input id="goodssafe4" type="radio" [value]="0" name="goodssafe4"
                        [(ngModel)]="ratingobj['goodssafe4']" />
                      <span class="fa fa-circle"></span>否
                    </label>
                  </div>
                </div>
                <div class="row col-sm-12 row-flex flex-aligns" style="padding:0;float: none;">
                  <label class="col-sm-9 control-label form-control-static"
                    style="white-space: normal;">5、不配合客户现场卸货工作、着装不端正、行为粗俗，收到客户投诉。</label>
                  <div class="col-sm-3">
                    <label class="radio-inline c-radio">
                      <input id="goodssafe5" type="radio" [value]="-20" name="goodssafe5"
                        [(ngModel)]="ratingobj['goodssafe5']" />
                      <span class="fa fa-circle"></span>是
                    </label>
                    <label class="radio-inline c-radio">
                      <input id="goodssafe5" type="radio" [value]="0" name="goodssafe5"
                        [(ngModel)]="ratingobj['goodssafe5']" />
                      <span class="fa fa-circle"></span>否
                    </label>
                  </div>
                </div>
                <div class="row mb col-sm-12 row-flex flex-aligns" style="padding:0;float: none;">
                  <input type="text" [(ngModel)]="ratingobj['morebeizhu']" class="form-control" placeholder="备注" />
                </div>
              </div>
            </div>
            <div class="form-group mb col-sm-12 row-flex flex-aligns" style="padding:0;float: none;">
              <label class="col-sm-2 control-label" style="padding:0;float: none;">二、赔偿能力</label>
              <div class="col-sm-10">
                <div class="row col-sm-12 row-flex flex-aligns" style="padding:0;float: none;">
                  <label class="col-sm-9 control-label form-control-static"
                    style="white-space: normal;">1、损坏客户现场财物能及时处理并赔偿的。</label>
                  <div class="col-sm-3">
                    <label class="radio-inline c-radio">
                      <input id="ability1" type="radio" [value]="-10" name="ability1"
                        [(ngModel)]="ratingobj['ability1']" />
                      <span class="fa fa-circle"></span>是
                    </label>
                    <label class="radio-inline c-radio">
                      <input id="ability1" type="radio" [value]="0" name="ability1"
                        [(ngModel)]="ratingobj['ability1']" />
                      <span class="fa fa-circle"></span>否
                    </label>
                  </div>
                </div>
                <div class="row col-sm-12 row-flex flex-aligns" style="padding:0;float: none;">
                  <label class="col-sm-9 control-label form-control-static"
                    style="white-space: normal;">2、损坏客户现场财物不配合处理的。</label>
                  <div class="col-sm-3">
                    <label class="radio-inline c-radio">
                      <input id="ability2" type="radio" [value]="true" name="ability2"
                        [(ngModel)]="ratingobj['ability2']" />
                      <span class="fa fa-circle"></span>是
                    </label>
                    <label class="radio-inline c-radio">
                      <input id="ability2" type="radio" [value]="false" name="ability2"
                        [(ngModel)]="ratingobj['ability2']" />
                      <span class="fa fa-circle"></span>否
                    </label>
                  </div>
                </div>
              </div>
            </div>
            <div class="form-group mb fieldsetdnn col-sm-12 row-flex flex-aligns" style="padding:0;float: none;">
              <label class="col-sm-2 control-label" style="padding:0;float: none;">损坏图片上传</label>
              <div class="col-sm-10">
                <div class="row mb col-sm-12 row-flex flex-aligns" style="padding:0;float: none;">
                  <label class="col-sm-9 control-label form-control-static" style="white-space: normal;">
                    <a [href]="url" target="_blank"> {{url}} </a>
                  </label>
                  <label class="col-sm-1 control-label form-control-static" *ngIf="url">
                    <i class="fa fa-trash-o fa-lg" (click)="deleteurl()"></i>
                  </label>
                  <div class="col-sm-2 radio-inline c-radio">
                    <button type="button" (click)="picUploader()" class="btn btn-info btn-sm margin-top-bottom-25">上传
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <div class="form-inline text-center">
            <div class="form-inline text-center">
              <button type="button" (click)="pingjiasave()" class="btn btn-primary btn-large">提交</button>
              <button type="button" (click)="hidepingjiawuliu()" class="btn btn-info btn-large">取消</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="modal" bsModal #parentModal="bs-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
    aria-hidden="false">
    <div class="modal-dialog modal-xs">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" aria-label="Close" (click)="hideuploadDialog()">
            <span aria-hidden="true">&times;</span>
          </button>
          <h4 class="modal-title">上传队列</h4>
        </div>
        <wisk-uploader [uploadParam]="uploadParam" [accept]="accept" (select)="uploads($event)"></wisk-uploader>

        <div class="form-inline">
        </div>
      </div>
    </div>
  </div>
</div>

<!-- 费用修改 -->
<div class="modal" bsModal #updateFeeModal="bs-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-xs">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" aria-label="Close" (click)="closeUpdateFeeModal()">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title">费用修改</h4>
      </div>
      <div class="modal-body">
        <div class="panel panel-default">
          <div class="panel-body">
            <div class="form-group mb fieldsetdnn col-sm-12">
              <label class="col-sm-3 control-label">系统单价：</label>
              <!-- <div class="col-sm-9">
                <input type="number" [(ngModel)]="updatefee['innerprice']" class="form-control" placeholder="请输入实付单价" />
              </div> -->
              <div class="col-sm-9">
                <input type="number" [(ngModel)]="updatefee['innerprice']" class="form-control" placeholder="请输入系统单价" />
              </div>
            </div>
            <div class="form-group mb fieldsetdnn col-sm-12">
              <label class="col-sm-3 control-label">费用单位</label>
              <div class="col-sm-9">
                <wis-feecompanysearch (select)="isyunyingzhongxin()" [(company)]="companyOfProduce">
                </wis-feecompanysearch>
              </div>
            </div>
            <div class="form-group mb fieldsetdnn col-sm-12" *ngIf="updatefee['feecustomerid']==='9545'">
              <label class="col-sm-3 control-label">实际费用单位</label>
              <div class="col-sm-9">
                <wis-feecompanysearch [(company)]="actualfeecustomer"></wis-feecompanysearch>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <div class="form-inline text-center">
          <div class="form-inline text-center">
            <button type="button" (click)="updateFee()" class="btn btn-primary btn-large">确定</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- 资金占用利息添加-->
<div class="modal" bsModal #interestAddModal="bs-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-md">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" aria-label="Close" (click)="hideInterestAddModal()">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title">资金占用利息登记</h4>
      </div>
      <div class="modal-body">
        <div class="panel panel-default">
          <div class="panel-body">
            <div class="form-group mb fieldsetdnn col-sm-12">
              <label class="col-sm-4 control-label">本合同应付利息</label>
              <div class="col-sm-8">
                <input type="text" [(ngModel)]="interestAddParams['yingfujine']" class="form-control" disabled />
              </div>
            </div>
            <div class="form-group mb fieldsetdnn col-sm-12">
              <label class="col-sm-4 control-label">客户余额</label>
              <div class="col-sm-8" style="text-align:right;">
                ￥{{interestAddParams['yue'] | number:'1.2-2'}}
              </div>
            </div>
            <div class="form-group mb fieldsetdnn col-sm-12">
              <label class="col-sm-4 control-label">货款金额</label>
              <div class="col-sm-8" style="text-align:right;">
                ￥{{tihuo['tjine'] | number:'1.2-2'}}
              </div>
            </div>
            <div class="form-group mb fieldsetdnn col-sm-12">
              <label class="col-sm-4 control-label">利息支付</label>
              <div class="col-sm-8">
                <label class="radio-inline c-radio">
                  <input type="radio" name="iszhifu" [value]="true" [(ngModel)]="interestAddParams['iszhifu']" />
                  <span class="fa fa-circle"></span>是</label>
                <label class="radio-inline c-radio">
                  <input type="radio" name="iszhifu" [value]="false" [(ngModel)]="interestAddParams['iszhifu']" />
                  <span class="fa fa-circle"></span>否</label>
              </div>
            </div>
            <div class="form-group mb fieldsetdnn col-sm-12">
              <label class="col-sm-4 control-label">欠款金额（货款）</label>
              <div class="col-sm-8">
                <input type="number" [(ngModel)]="interestAddParams['qiankuanhuokuanjine']" class="form-control" placeholder="请输入欠款货款金额" disabled />
              </div>
            </div>
            <div class="form-group mb fieldsetdnn col-sm-12" *ngIf="interestAddParams['iszhifu']">
              <label class="col-sm-4 control-label">{{interestAddParams['isqiankuan']?"欠款金额（利息）":"实付利息"}}</label>
              <div class="col-sm-8">
                <input type="number" [(ngModel)]="interestAddParams['jine']" class="form-control" [placeholder]="'请输入'+interestAddParams['isqiankuan']?'欠款利息金额':'实付利息'" (ngModelChange)="qiankuanjineChange()"/>
              </div>
            </div>
            <div class="form-group mb fieldsetdnn col-sm-12" *ngIf="interestAddParams['iszhifu']&&interestAddParams['isqiankuan']">
              <label class="col-sm-4 control-label">欠款天数</label>
              <div class="col-sm-8">
                <input type="number" [(ngModel)]="interestAddParams['qiankuandays']" class="form-control" placeholder="请输入欠款天数" />
              </div>
            </div>
            <div class="form-group mb fieldsetdnn col-sm-12" *ngIf="interestAddParams['iszhifu']&&interestAddParams['isqiankuan']">
              <label class="col-sm-4 control-label">还款日期</label>
              <div class="col-sm-8 wiskind-calendar">
                <p-calendar [(ngModel)]="yedate" placeholder="还款日期" [minDate]="minDate"></p-calendar>
              </div>
            </div>
            <div class="form-group mb fieldsetdnn col-sm-12" *ngIf="interestAddParams['iszhifu']&&interestAddParams['isqiankuan']">
              <label class="col-sm-4 control-label">欠款原因</label>
              <div class="col-sm-8">
                <input type="text" [(ngModel)]="interestAddParams['qiankuanreason']" class="form-control" placeholder="请输入欠款原因" />
              </div>
            </div>
            <p *ngIf="interestAddParams['iszhifu']&&interestAddParams['isqiankuan']" style="color:red;">*&nbsp;客户余额&nbsp;&lt;&nbsp;利息+货款，则创建欠款</p>
            <p *ngIf="interestAddParams['iszhifu']&&!interestAddParams['isqiankuan']" style="color:red;">*&nbsp;客户余额&nbsp;&gt;&nbsp;利息+货款，则创建补差单</p>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <div class="form-inline text-center">
          <div class="form-inline text-center">
            <button type="button" (click)="saveinterest()" class="btn btn-primary btn-large">保存</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>


<!-- 批量费用修改 -->
<div class="modal" bsModal #updatemanyFeeModal="bs-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-xs">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" aria-label="Close" (click)="closeUpdatemanyFeeModal()">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title">费用修改</h4>
      </div>
      <div class="modal-body">
        <div class="panel panel-default">
          <div class="panel-body">
            <div class="form-group mb fieldsetdnn col-sm-12">
              <label class="col-sm-3 control-label">系统单价：</label>
              <div class="col-sm-9">
                <input type="number" [(ngModel)]="updatefee['innerprice']" class="form-control" placeholder="请输入系统单价" />
              </div>
            </div>
            <div class="form-group mb fieldsetdnn col-sm-12">
              <label class="col-sm-3 control-label">费用单位</label>
              <div class="col-sm-9">
                <wis-feecompanysearch (select)="isyunyingzhongxin()" [(company)]="companyOfProduce">
                </wis-feecompanysearch>
              </div>
            </div>
            <div class="form-group mb fieldsetdnn col-sm-12" *ngIf="updatefee['feecustomerid']==='9545'">
              <label class="col-sm-3 control-label">实际费用单位</label>
              <div class="col-sm-9">
                <wis-feecompanysearch [(company)]="actualfeecustomer"></wis-feecompanysearch>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <div class="form-inline text-center">
          <div class="form-inline text-center">
            <button type="button" (click)="updatemanyFee()" class="btn btn-primary btn-large">确定</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
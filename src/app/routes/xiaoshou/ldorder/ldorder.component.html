<div class="button-toolbar clearfix mb">
  <div class="btn-group">
    <h4>
      <em class="fa fa-book"></em>临调订单明细
    </h4>
  </div>
  <div class="pull-right ml-lg">
    <button type="button" (click)="openmodifymain()" class="btn btn-info btn-sm margin-top-bottom-25">修改订单</button>
    <button *ngIf="qihuoflag['detail']" type="button" (click)="addqihuodialog()"
      class="btn btn-info btn-sm margin-top-bottom-25">添加明细
    </button>
    <button *ngIf="qihuoflag['issubmit']" type="button" (click)="submitverify()"
      class="btn btn-info btn-sm margin-top-bottom-25">提交审核
    </button>
    <button type="button" (click)="shownoticewuliuyuan()"
      class="btn btn-info btn-sm margin-top-bottom-25">通知物流专员</button>
    <!-- <button *ngIf="qihuoflag['isv']" type="button" (click)="verifyqihuo()" class="btn btn-info btn-sm margin-top-bottom-25">审核
    </button> -->
    <button *ngIf="qihuoflag['fisv']" type="button" (click)="removeverify()"
      class="btn btn-info btn-sm margin-top-bottom-25">撤销审核
    </button>
    <button type="button" (click)="print()" class="btn btn-info btn-sm margin-top-bottom-25">打印预览
    </button>
    <button type="button" (click)="ordermodalchangeshow()" class="btn btn-info btn-sm margin-top-bottom-25">生成PDF
    </button>
    <button class="btn btn-info btn-bloc" style="background-color:red;border-color:red;color:#ffffff;" type="button"
    (click)="delldorder()">货物明细批量删除</button>
  </div>
</div>

<div class="panel panel-default wis-auto">
  <div class="row fieldsetdnn">
    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 form-control-static">买方公司:</div>
        <div class="col-md-8 col-xs-6 form-control-static">{{ldordermodel['buyer'] | customer}}</div>
      </div>
    </div>

    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 form-control-static">卖方公司:</div>
        <div class="col-md-8 col-xs-6 form-control-static">{{ldordermodel['seller'] | customer}}</div>
      </div>
    </div>

    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 control-label form-control-static">所属机构:</div>
        <div class="col-md-8 col-xs-6 form-control-static">
          {{ldordermodel['org']['name']}}
        </div>
      </div>
    </div>

    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 control-label form-control-static">支付方式:</div>
        <div class="col-md-8 col-xs-6 form-control-static">
          {{ldordermodel['paytype'] | orderpaytype}}
        </div>
      </div>
    </div>

  </div>

  <div class="row fieldsetdnn">

    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 control-label form-control-static">订单编号:</div>
        <div class="col-md-8 col-xs-6 form-control-static">{{ldordermodel['billno']}}</div>
      </div>
    </div>
    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 control-label form-control-static">版本:</div>
        <div class="col-md-8 col-xs-6 form-control-static">
          {{ldordermodel['version']}}
        </div>
      </div>
    </div>

    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 control-label form-control-static">订单类型:</div>
        <div class="col-md-8 col-xs-6 form-control-static">{{ldordermodel['ordertype'] | ordertype}}</div>
      </div>
    </div>

    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 control-label form-control-static">运输类型:</div>
        <div class="col-md-8 col-xs-6 form-control-static">{{ldordermodel['type'] | transtype}}</div>
      </div>
    </div>

  </div>
  <div class="row fieldsetdnn">

    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 form-control-static">总重量:</div>
        <div class="col-md-8 col-xs-6 form-control-static">{{ldordermodel['tweight']}}</div>
      </div>
    </div>
    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 control-label form-control-static">金额:</div>
        <div class="col-md-8 col-xs-6 form-control-static">
          {{ldordermodel['tjine']}}
        </div>
      </div>
    </div>

    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 control-label form-control-static">数量:</div>
        <div class="col-md-8 col-xs-6 form-control-static">{{ldordermodel['tcount']}}</div>
      </div>
    </div>
    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 control-label form-control-static">更新时间:</div>
        <div class="col-md-8 col-xs-6 form-control-static">{{ldordermodel['udate']}}</div>
      </div>
    </div>
  </div>

  <div class="row fieldsetdnn">

    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 form-control-static">制单人:</div>
        <div class="col-md-8 col-xs-6 form-control-static">{{ldordermodel['cuser']['realname']}}</div>
      </div>
    </div>
    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 control-label form-control-static">制单时间:</div>
        <div class="col-md-8 col-xs-6 form-control-static">{{ldordermodel['cdate']}}</div>
      </div>
    </div>
    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 control-label form-control-static">审核人:</div>
        <div class="col-md-8 col-xs-6 form-control-static">{{ldordermodel['vuser']['realname']}}</div>
      </div>
    </div>

    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 control-label form-control-static">审核时间:</div>
        <div class="col-md-8 col-xs-6 form-control-static">{{ldordermodel['vdate']}}</div>
      </div>
    </div>

  </div>

  <div class="row fieldsetdnn">
    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 form-control-static">约定定金:</div>
        <div class="col-md-8 col-xs-6">
          <input [disabled]="qihuoflag['isdingjinedit']" type="number" placeholder="请输入约定定金"
            [(ngModel)]="ldordermodel['dingjin']" class="form-control" (blur)="calcyufurate()" />
        </div>
      </div>
    </div>
    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 form-control-static">约定比率:</div>
        <div class="col-md-8 col-xs-6">
          <input class="form-control" style="display: inline-block;" maxlength="8" name="amount" type="text"
            [disabled]="qihuoflag['isdingjinedit']" [(ngModel)]="oldyufurate" placeholder="请输入约定比率"
            (blur)="calcdingjin()" />
        </div>
      </div>
    </div>
    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 form-control-static">订单状态:</div>
        <div class="col-md-8 col-xs-6 form-control-static">
          {{ldordermodel['qihuostatus'] | qihuostatus}}
        </div>
      </div>
    </div>

  </div>

  <div class="row fieldsetdnn" *ngIf="ldordermodel['type'] == 1">
    <div class="col-lg-6 col-md-6">
      <div class="row">
        <div class="col-md-2 col-xs-6 form-control-static">收货地址:</div>
        <div class="col-md-10 col-xs-6 form-control-static">
          {{(ldordermodel['addrbak']['province'] ? ldordermodel['addrbak']['province'] : '') +
          (ldordermodel['addrbak']['city'] ? ldordermodel['addrbak']['city'] : '') + (ldordermodel['addrbak']['county']
          ? ldordermodel['addrbak']['county'] :'') + ldordermodel['addrbak']['detail']}}
        </div>
      </div>
    </div>
  </div>

  <div class="row fieldsetdnn">
    <div class=" col-lg-6 col-md-6">
      <div class="row">
        <div class="col-md-2 col-xs-6 control-label form-control-static">备注:</div>
        <div class="col-md-10 col-xs-6">
          <input type="text" placeholder="请输入备注" [(ngModel)]="ldordermodel['beizhu']" class="form-control"
            (blur)="modify(ldordermodel)" />
        </div>
      </div>
    </div>
  </div>


  <div class="viewpanel">
    <p-tabView [style]="{'padding-top': '3px'}" [activeIndex]="tabviewindex" (onChange)="handleChange($event)">
      <p-tabPanel header="销售明细"
        [headerStyle]="{'background-color': '#fff', 'border-color': '#ccc','border-bottom-color': 'rgba(0, 0, 0, 0)','margin-left': '5px'}">
        <ag-grid-angular [ngStyle]="{'height': (settings.bodyHeight - 500)+'px'}" #agGrid
          style="width: calc(100% + 22px);height:100%;margin:0 -11px;margin-top:-5px;" class="ag-blue"
          [gridOptions]="gridOptions">
        </ag-grid-angular>
      </p-tabPanel>
      <p-tabPanel header="钢卷明细" [headerStyle]="{'background-color': '#fff', 'border-color': '#ccc',color: '#ddd'}">
        <ag-grid-angular [ngStyle]="{'height': (settings.bodyHeight - 500)+'px'}" #agGrid
          style="width: calc(100% + 22px);height:100%;margin:0 -11px;margin-top:-5px;" class="ag-blue"
          [gridOptions]="ordergridOptions">
        </ag-grid-angular>
      </p-tabPanel>
      <p-tabPanel header="物流竞价明细" [headerStyle]="{'background-color': '#fff', 'border-color': '#ccc',color: '#ddd'}">
        <ag-grid-angular [ngStyle]="{'height': (settings.bodyHeight - 500)+'px'}" #agGrid
          style="width: calc(100% + 22px);height:100%;margin:0 -11px;margin-top:-5px;" class="ag-blue"
          [gridOptions]="wuliuOffergridOptions">
        </ag-grid-angular>
      </p-tabPanel>

    </p-tabView>
  </div>
</div>
<toaster-container></toaster-container>

<!--添加期货明细对话框-->
<div class="modal" bsModal #createqihuodialog="bs-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-xs">
    <div class="modal-content">
      <div class="modal-header">
        <button class="close" type="button" aria-label="Close" (click)="qihuodialogcoles()">
            <span aria-hidden="true">&times;</span>
        </button>
        <button type="button" (click)="querymat()" style="float: right;margin-right:15px;" class="btn btn-primary" *ngIf="one">
        查询
        </button>
        <input type="text" style="float: right;width: 150px;height: 30px;margin: 0 10px" [(ngModel)]="qihuodetmodel['matcode']" placeholder="请输入物料编码" class="form-control"  *ngIf="one" />
        <h4 class="modal-title">添加明细</h4>
      </div>
      <div class="modal-body">
        <div class="panel panel-default">
          <div class="panel-body">
            <div *ngIf="one">
              <div class="form-group mb fieldsetdnn row">
                <label class="col-sm-3 control-label">
                  <span style="float: right;">品名：</span>
                </label>
                <div class="col-sm-9">
                  <!-- <p-dropdown [options]="gns" (onChange)="selectedgn($event.value)" [(ngModel)]="qihuodetmodel['gnid']"
                    placeholder="选择品名" [filter]="true" [style]="{'width': '100%'}">
                  </p-dropdown> -->
                  <input (click)="mdmgndialog.show()" [(ngModel)]="goodscode['gn']" class="form-control" placeholder="请选择品名" readonly>
                </div>
              </div>
              <div *ngIf="showGuige">
                <div class="form-group mb fieldsetdnn row" *ngFor="let item of attrs">
                  <label class="col-sm-3 control-label requiredlabel">
                    <span style="float: right;" [ngClass]="{'requiredbefore':item.isrequired}">{{item.name}}：</span>
                  </label>
                  <div class="col-sm-9">
                    <p-dropdown [options]="item.options" placeholder='请选择{{item.label}}'
                      [(ngModel)]="goodscode[item.value]" (onChange)="selectattr(item,$event.value)" [filter]="true" [style]="{'width': '100%'}">
                    </p-dropdown>
                  </div>
                </div>
              </div>
              <!-- <div class="form-group mb fieldsetdnn row">
                <label class="col-sm-3 control-label">
                  <span style="float: right;">产地：</span>
                </label>
                <div class="col-sm-9">
                  <p-dropdown [options]="chandis" (onChange)="selectedchandi($event.value)" placeholder="选择产地"
                    [(ngModel)]="qihuodetmodel['chandiid']" [filter]="true" [style]="{'width': '100%'}"
                    [disabled]="!isChandi">
                  </p-dropdown>
                </div>
              </div>
              <div *ngIf="showGuige">
                <div class="form-group mb fieldsetdnn row" *ngFor="let item of attrs">
                  <label class="col-sm-3 control-label">
                    <span style="float: right;">{{item.label}}：</span>
                  </label>
                  <div class="col-sm-9">
                    <p-dropdown [filter]="true" [options]="item.options" placeholder='请选择{{item.label}}'
                      (onChange)="selectedguige($event,item.name)" [style]="{'width': '100%'}">
                    </p-dropdown>
                  </div>
                </div>
              </div> -->
            </div>
            <div *ngIf="two">
              <div class="form-group mb fieldsetdnn row">
                <label class="col-sm-3 control-label">
                  <span style="float: right;">订货量：</span>
                </label>
                <div class="col-sm-9">
                  <input [(ngModel)]="qihuodetmodel['dinghuoliang']" class="form-control" placeholder="请输入订货量" required>
                </div>
              </div>
              <div class="form-group mb fieldsetdnn row">
                <label class="col-sm-3 control-label">
                  <span style="float: right;">销售价格：</span>
                </label>
                <div class="col-sm-6">
                  <input [(ngModel)]="qihuodetmodel['saleprice']" class="form-control" placeholder="请输入销售价格" disabled
                    required>
                </div>
                <div class="col-sm-3">
                  <button type="button" (click)="feeadddialogshow()" class="btn btn-info btn-large">添加</button>
                </div>
              </div>

              <div *ngIf="islindiao" class="form-group mb fieldsetdnn row">
                <label class="col-sm-3 control-label">
                  <span style="float: right;">所在仓库：</span>
                </label>
                <div class="col-sm-9">
                  <p-dropdown [filter]="true" [options]="cangkus" [(ngModel)]="qihuodetmodel['cangkuid']"
                    placeholder="选择仓库" [style]="{'width': '100%'}">
                  </p-dropdown>
                </div>
              </div>
            </div>

          </div>
        </div>
      </div>
      <div class="form-inline text-center">
        <div *ngIf="one">
          <button type="button" (click)="createselectNull()" class="btn btn-info btn-large">重选</button>
          <button type="button" (click)="nextdialog1()" class="btn btn-primary btn-large">下一步</button>
        </div>
        <div *ngIf="two">
          <button type="button" (click)="createselectNull()" class="btn btn-info btn-large">重选</button>
          <button type="button" (click)="create()" class="btn btn-primary btn-large">创建</button>
        </div>


      </div>
    </div>
  </div>
</div>

<!--费用添加弹出窗口-->
<div class="modal" bsModal #feeadddialog="bs-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <button class="close" type="button" aria-label="Close" (click)="feeadddialogclose()">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title pull-left">价格/费用添加</h4>
      </div>

      <div class="modal-body">
        <div class="panel panel-default">
          <div class="panel-body">

            <div class="row">
              <div class="col-md-3 col-sm-3  text-center">
                <label class="col-sm-12 control-label form-control-static">销售单价</label>
              </div>
              <div class="col-md-1 col-sm-1  text-center">
                <label class="col-sm-12 control-label">-</label>
              </div>
              <div class="col-md-2 col-sm-2  text-center">
                <label class="col-sm-12 control-label form-control-static">考核单价</label>
              </div>
              <div class="col-md-1 col-sm-1  text-center">
                <label class="col-sm-12 control-label">-</label>
              </div>
              <div class="col-md-2 col-sm-2  text-center">
                <label class="col-sm-12 control-label form-control-static">费用合计单价</label>
              </div>
              <div class="col-md-1 col-sm-1 text-center">
                <label class="col-sm-12 control-label">=</label>
              </div>
              <div class="col-md-2 col-sm-2 text-center">
                <label class="col-sm-12 control-label form-control-static">预估毛利</label>
              </div>
            </div>

            <div class="row">
              <div class="col-md-3 col-sm-3 text-center">
                <input style="text-align:center" [(ngModel)]="qihuodetmodel['saleprice']" class="form-control"
                  placeholder="请输入销售价格" required>
              </div>
              <div class="col-md-1 col-sm-1  text-center">
                -
              </div>
              <div class="col-md-2 col-sm-2 text-center">
                <input style="text-align:center" [(ngModel)]="qihuodetmodel['neibujiesuanprice']" class="form-control"
                  placeholder="请输入内部结算价" required>
              </div>
              <div class="col-md-1 col-sm-1 text-center">
                -
              </div>
              <div class="col-md-2 col-sm-2 text-center">
                {{feeHeji}}
              </div>
              <div class="col-md-1 col-sm-1 text-center">
                =
              </div>
              <div class="col-md-2 col-sm-2 text-center">
                {{qihuodetmodel['saleprice'] - qihuodetmodel['neibujiesuanprice'] - feeHeji}}
              </div>
            </div>

            <div class="form-group mb fieldsetdnn col-sm-12 col-md-12"></div>

            <div class="row">
              <div class="col-sm-3 text-center">
                <label class="col-sm-12 control-label form-control-static">费用类型</label>
              </div>
              <div class="col-sm-3 text-center">
                <label class="col-sm-12 control-label form-control-static">单价</label>
              </div>
              <div class="col-sm-3 text-center">
                <label class="col-sm-12 control-label form-control-static">备注</label>
              </div>
              <div class="col-sm-3 text-center">
                <label class="col-sm-12 control-label form-control-static">
                  <span *ngIf="!isshowInput" class="label label-info" (click)="showInput()">插入费用</span>
                  <span *ngIf="isshowInput" class="label label-info" (click)="showInput()">取消插入</span>
                </label>
              </div>
            </div>

            <div class="row" *ngIf="isshowInput">
              <div class="col-sm-3">
                <p-dropdown [options]="feetypes" [(ngModel)]="feemodel['feetype']" placeholder="选择费用类型"
                  [style]="{'width': 'calc(100% - 30px)','margin': '0 15px'}">
                </p-dropdown>
              </div>
              <div class="col-sm-3">
                <input style="width:calc(100% - 30px); margin: 0 15px" class="form-control"
                  [(ngModel)]="feemodel['price']" placeholder="请输入费用单价" required>
              </div>
              <div class="col-sm-3">
                <input style="width:calc(100% - 30px); margin: 0 15px" class="form-control"
                  [(ngModel)]="feemodel['beizhu']" placeholder="请输入备注" required>
              </div>
              <div class="col-sm-3 text-center">
                <button type="button" (click)="insertline()" class="btn btn-primary btn-large">插入费用</button>
              </div>
            </div>

            <div class="row fieldsetdnn" *ngFor="let item of lines;index as i;">
              <div class="col-sm-3 text-center">
                <span>{{item.feetype|feetype}}</span>
              </div>
              <div class="col-sm-3 text-center">
                <span>{{item.feeprice}}</span>
              </div>
              <div class="col-sm-3 text-center">
                <span>{{item.beizhu}}</span>
              </div>
              <div class="col-sm-3 text-center">
                <span style="padding-left: 80px" (click)="delorderfee(i,item.feeprice)">
                  <a>删除</a>
                </span>
              </div>
            </div>

          </div>
        </div>
      </div>
      <div class="modal-footer">
        <div class="form-inline text-center">
          <div class="form-inline text-center">
            <button type="button" (click)="feeadddialogclose()" class="btn btn-primary btn-large">确定</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!--临调明细修改对话框-->
<div class="modal" bsModal #editqihuodialog="bs-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <button class="close" type="button" aria-label="Close" (click)="editqihuodialogcoles()">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title">修改明细</h4>
      </div>
      <div class="modal-body">
        <div class="panel panel-default">
          <div class="panel-body">
            <div class="form-group mb fieldsetdnn row col-md-6">
              <label class="col-sm-3 control-label">
                <span>品名：</span>
              </label>
              <div class="col-sm-9">
                <p-dropdown [options]="gns1" (onChange)="selectedgn1($event.value)" [(ngModel)]="editmodel['gnid']"
                  placeholder="选择品名" [filter]="true" [style]="{'width': '100%'}">
                </p-dropdown>
              </div>
            </div>
            <div class="form-group mb fieldsetdnn row col-md-6">
              <label class="col-sm-3 control-label">
                <span>产地：</span>
              </label>
              <div class="col-sm-9">
                <p-dropdown [options]="chandis1" (onChange)="selectedchandi1($event.value,false)" placeholder="选择产地"
                  [(ngModel)]="editmodel['chandiid']" [filter]="true" [style]="{'width': '100%'}"
                  [disabled]="!isChandi1">
                </p-dropdown>
              </div>
            </div>
            <div *ngIf="showGuige1">
              <div class="form-group mb fieldsetdnn row col-md-6" *ngFor="let item of attrs1">
                <label class="col-sm-4 control-label">
                  <span>{{item.label}}：</span>
                </label>
                <div class="col-sm-8">
                  <p-dropdown [filter]="true" [options]="item.options" placeholder='请选择{{item.label}}'
                    (onChange)="selectedguige1($event,item.name)" [(ngModel)]="editguige[item.name]"
                    [style]="{'width': '100%'}">
                  </p-dropdown>
                </div>
              </div>
            </div>
            <div class="form-group mb fieldsetdnn row col-md-6">
              <label class="col-sm-4 control-label">
                <span>订货量：</span>
              </label>
              <div class="col-sm-8">
                <input [(ngModel)]="editmodel['weight']" class="form-control" placeholder="请输入订货量">
              </div>
            </div>
            <div class="form-group mb fieldsetdnn row col-md-6">
              <label class="col-sm-4 control-label">
                <span>销售价格：</span>
              </label>
              <div class="col-sm-8">
                <input [(ngModel)]="editmodel['saleprice']" class="form-control" placeholder="请输入销售价格">
              </div>
            </div>
            <div *ngIf="islindiao" class="form-group mb fieldsetdnn row col-md-6">
              <label class="col-sm-4 control-label">
                <span>所在仓库：</span>
              </label>
              <div class="col-sm-8">
                <p-dropdown [filter]="true" [options]="cangkus" [(ngModel)]="editmodel['cangkuid']" placeholder="选择仓库"
                  [style]="{'width': '100%'}">
                </p-dropdown>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="form-inline text-center">
        <button type="button" (click)="createselectNull1()" class="btn btn-info btn-large">重选</button>
        <button type="button" (click)="create1()" class="btn btn-primary btn-large">修改</button>
      </div>
    </div>
  </div>
</div>

<!--费用添加弹出窗口-->
<div class="modal" bsModal #editdetfeeadddialog="bs-modal" tabindex="-1" role="dialog"
  aria-labelledby="mySmallModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <button class="close" type="button" aria-label="Close" (click)="feeadddialogclose1()">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title pull-left">价格/费用添加</h4>
      </div>

      <div class="modal-body">
        <div class="panel panel-default">
          <div class="panel-body">

            <div class="row">
              <div class="col-md-3 col-sm-3  text-center">
                <label class="col-sm-12 control-label form-control-static">销售单价</label>
              </div>
              <div class="col-md-1 col-sm-1  text-center">
                <label class="col-sm-12 control-label">-</label>
              </div>
              <div class="col-md-2 col-sm-2  text-center">
                <label class="col-sm-12 control-label form-control-static">考核单价</label>
              </div>
              <div class="col-md-1 col-sm-1  text-center">
                <label class="col-sm-12 control-label">-</label>
              </div>
              <div class="col-md-2 col-sm-2  text-center">
                <label class="col-sm-12 control-label form-control-static">费用合计单价</label>
              </div>
              <div class="col-md-1 col-sm-1 text-center">
                <label class="col-sm-12 control-label">=</label>
              </div>
              <div class="col-md-2 col-sm-2 text-center">
                <label class="col-sm-12 control-label form-control-static">预估毛利</label>
              </div>
            </div>

            <div class="row">
              <div class="col-md-3 col-sm-3 text-center">
                <input style="text-align:center" [(ngModel)]="editmodel['saleprice']" class="form-control"
                  placeholder="请输入销售价格">
              </div>
              <div class="col-md-1 col-sm-1  text-center">
                -
              </div>
              <div class="col-md-2 col-sm-2 text-center">
                <input style="text-align:center" [(ngModel)]="editmodel['neibujiesuanprice']" class="form-control"
                  placeholder="请输入内部结算价">
              </div>
              <div class="col-md-1 col-sm-1 text-center">
                -
              </div>
              <div class="col-md-2 col-sm-2 text-center">
                {{feeHeji1}}
              </div>
              <div class="col-md-1 col-sm-1 text-center">
                =
              </div>
              <div class="col-md-2 col-sm-2 text-center">
                {{editmodel['saleprice'] - editmodel['neibujiesuanprice'] - feeHeji1}}
              </div>
            </div>

            <div class="form-group mb fieldsetdnn col-sm-12 col-md-12"></div>

            <div class="row">
              <div class="col-sm-3 text-center">
                <label class="col-sm-12 control-label form-control-static">费用类型</label>
              </div>
              <div class="col-sm-3 text-center">
                <label class="col-sm-12 control-label form-control-static">单价</label>
              </div>
              <div class="col-sm-3 text-center">
                <label class="col-sm-12 control-label form-control-static">备注</label>
              </div>
              <div class="col-sm-3 text-center">
                <label class="col-sm-12 control-label form-control-static">
                  <span *ngIf="!showInput1" class="label label-info" (click)="showInput1()">插入费用</span>
                  <span *ngIf="showInput1" class="label label-info" (click)="showInput1()">取消插入</span>
                </label>
              </div>
            </div>

            <div class="row" *ngIf="isshowInput1">
              <div class="col-sm-3">
                <p-dropdown [options]="feetypes" [(ngModel)]="feemodel1['feetype']" placeholder="选择费用类型"
                  [style]="{'width': 'calc(100% - 30px)','margin': '0 15px'}">
                </p-dropdown>
              </div>
              <div class="col-sm-3">
                <input style="width:calc(100% - 30px); margin: 0 15px" class="form-control"
                  [(ngModel)]="feemodel1['price']" placeholder="请输入费用单价" required>
              </div>
              <div class="col-sm-3">
                <input style="width:calc(100% - 30px); margin: 0 15px" class="form-control"
                  [(ngModel)]="feemodel1['beizhu']" placeholder="请输入备注" required>
              </div>
              <div class="col-sm-3 text-center">
                <button type="button" (click)="insertline1()" class="btn btn-primary btn-large">插入费用</button>
              </div>
            </div>

            <div class="row fieldsetdnn" *ngFor="let item of lines1;index as i;">
              <div class="col-sm-3 text-center">
                <span>{{item.feetype|feetype}}</span>
              </div>
              <div class="col-sm-3 text-center">
                <span>{{item.feeprice}}</span>
              </div>
              <div class="col-sm-3 text-center">
                <span>{{item.beizhu}}</span>
              </div>
              <div class="col-sm-3 text-center">
                <span style="padding-left: 80px" (click)="delorderfee1(i,item.feeprice)">
                  <a>删除</a>
                </span>
              </div>
            </div>

          </div>
        </div>
      </div>
      <div class="modal-footer">
        <div class="form-inline text-center">
          <div class="form-inline text-center">
            <button type="button" (click)="feeadddialogclose1()" class="btn btn-primary btn-large">确定</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- 修改主表信息 -->
<div class="modal" bsModal #mainmodifydialog="bs-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-xs">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" aria-label="Close" (click)="closemaindialog()">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title">修改</h4>
      </div>
      <div class="modal-body">
        <div class="panel panel-default">
          <div class="panel-body">
            <div class="form-group mb fieldsetdnn row">
              <label class="col-sm-3 control-label">配送方式:</label>
              <div class="col-sm-9">
                <label class="radio-inline c-radio">
                  <input id="inlineradio1" type="radio" name="i-radio" [value]="0" [(ngModel)]="editorder['type']" />
                  <span class="fa fa-circle"></span>自提
                </label>
                <label class="radio-inline c-radio">
                  <input id="inlineradio2" type="radio" name="i-radio" [value]="1" [(ngModel)]="editorder['type']"
                    (ngModelChange)="getAddr()" />
                  <span class="fa fa-circle"></span>代运
                </label>
                <label class="radio-inline c-radio">
                  <input id="inlineradio3" type="radio" name="i-radio" [value]="2" [(ngModel)]="editorder['type']" />
                  <span class="fa fa-circle"></span>转货
                </label>
              </div>
            </div>
            <div class="form-group mb fieldsetdnn row">
              <label class="col-sm-3 control-label">收货地址:</label>
              <div class="col-sm-7">
                <p-dropdown [options]="addrs" [(ngModel)]="editorder['addrid']" [style]="{'width':'100%'}"
                  [filter]="true" filterBy="label,value.name">
                </p-dropdown>
              </div>
              <div class="col-sm-2">
                <span class="input-group-btn">
                  <button type="button" class="btn btn-default" (click)="addAddrDialog()">
                    <i class="fa fa-plus"></i>
                  </button>
                </span>
              </div>
            </div>
          </div>
        </div>
        <div class="form-inline text-center">
          <button type="button" (click)="modifymain()" class="btn btn-primary btn-large">修改</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!--添加地址弹窗-->
<div class="modal" bsModal #addrdialog="bs-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-md">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" aria-label="Close" (click)="addrdialogclose()">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title">添加地址</h4>
      </div>
      <div class="modal-body">
        <div class="panel panel-default">
          <div class="panel-body">
            <div class="form-group mb fieldsetdnn col-sm-12 ">
              <label class="col-sm-3 control-label">地址：</label>
              <div class="col-sm-9">
                <p-dropdown [options]="provinces" [(ngModel)]="addr['provinceid']"
                  [style]="{'width':'100%','font-size':'15px'}" (onChange)="getcity()" [placeholder]="'请选择省份'">
                </p-dropdown>
              </div>
            </div>
            <div class="form-group mb fieldsetdnn col-sm-12">
              <label class="col-sm-3 control-label"></label>
              <div class="col-sm-9">
                <p-dropdown [options]="citys" [(ngModel)]="addr['cityid']" [style]="{'width':'100%','font-size':'15px'}"
                  (onChange)="getcounty()" [placeholder]="'请选择市'">
                </p-dropdown>
              </div>
            </div>
            <div class="form-group mb fieldsetdnn col-sm-12">
              <label class="col-sm-3 control-label"></label>
              <div class="col-sm-9">
                <p-dropdown [options]="countys" [(ngModel)]="addr['countyid']"
                  [style]="{'width':'100%','font-size':'15px'}" [placeholder]="'请选择县/区'"></p-dropdown>
              </div>
            </div>
            <div class="form-group mb fieldsetdnn col-sm-12 ">
              <label class="col-sm-3 control-label">详细地址：</label>
              <div class="col-sm-9">
                <input type="text" placeholder="请输入详细地址" [(ngModel)]="addr['detail']" class="form-control" required />
              </div>
            </div>
            <div class="form-group mb fieldsetdnn col-sm-12 ">
              <label class="col-sm-3 control-label">联系人：</label>
              <div class="col-sm-9">
                <input type="text" placeholder="请输入联系人" [(ngModel)]="addr['lianxiren']" class="form-control" required />
              </div>
            </div>
            <div class="form-group mb fieldsetdnn col-sm-12 ">
              <label class="col-sm-3 control-label">联系方式：</label>
              <div class="col-sm-9">
                <input type="text" placeholder="请输入联系方式" [(ngModel)]="addr['phone']" class="form-control" required />
              </div>
            </div>
          </div>
        </div>
        <div class="form-inline text-center">
          <button type="button" (click)="addAddr()" class="btn btn-primary btn-large">添加</button>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- 品名选择弹窗 -->
<div class="modal" bsModal #mdmgndialog="bs-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <button class="close" type="button" aria-label="Close" (click)="mdmgndialog.hide()">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title">物料分类码表报表</h4>
      </div>
      <app-mdmselectgn (select)="selectgn($event)"></app-mdmselectgn>
    </div>
  </div>
</div>

  <!--  选择模板的弹窗 -->
  <div class="modal" bsModal #ordermodalchange="bs-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
  aria-hidden="true">
    <div class="modal-dialog modal-xs">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" aria-label="Close" (click)="hideordermodalchange()">
            <span aria-hidden="true">&times;</span>
          </button>
          <h4 class="modal-title">模板选择</h4>
        </div>
        <div class="modal-body">
          <div class="panel panel-default">
            <div class="panel-body">
              <div class="col-sm-9">
                <p-dropdown [options]="ordermodal" placeholder="选择模板" [(ngModel)]="changeordermodal['ordermodal']"  [style]="{'width': '100%'}">
                </p-dropdown>
              </div>
              <div class="form-inline text-center">
                <button type="button" (click)="makepdf()" class="btn btn-primary btn-large">确定打印</button>
              </div>
         <!--      <div class="row fieldsetdnn">
                &emsp;&emsp;&emsp;&emsp;&emsp;
                <button  type="button" (click)="makepdf()" class="btn btn-info btn-large">默认模板</button>
                &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;
                <button  type="button"  (click)="makepdf()" class=" btn btn-info btn-large">老模板</button>              
              </div> -->
            </div>
          </div>
        </div>
      </div> 
    </div>
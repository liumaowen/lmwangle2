<div class="content-heading">
  <em class="fa fa-list-alt"></em> 加工订单
  <div class="pull-right">
    <button *ngIf="flag['show']" type="button" (click)="qualitShow()" class="btn btn-info btn-sm margin-top-bottom-25">质量异议</button>
    <button type="button" class="btn btn-info btn-bloc" (click)="cancelchoose()">取消选择</button>
    <button type="button" (click)="openmodifymain()" class="btn btn-info btn-sm margin-top-bottom-25">修改订单</button>
    <button type="button" (click)="shownoticewuliuyuan()"
      class="btn btn-info btn-sm margin-top-bottom-25">通知物流专员</button>
    <button *ngIf="flag['del']" type="button" class="btn btn-info btn-bloc"
      (click)="delproorder(proorder['id'])">删除订单</button>
    <button type="button" (click)="addallocationdialog()" class="btn btn-info btn-sm margin-top-bottom-25">配款
    </button>
    <button type="button" (click)="shifangallocationdialog()" class="btn btn-info btn-sm margin-top-bottom-25">释放配款
    </button>
    <button *ngIf="flag['import']" type="button" class="btn btn-info btn-bloc" (click)="importKucun()">引入库存基料</button>
    <button *ngIf="flag['import']" type="button" class="btn btn-info btn-bloc" (click)="importFav()">引入收藏夹基料</button>
    <button *ngIf="flag['show']" type="button" class="btn btn-info btn-bloc" (click)="addProducts()">添加成品</button>
    <button *ngIf="flag['show']" type="button" class="btn btn-info btn-bloc" (click)="submitVerify()">提交审核</button>
    <!--<button *ngIf="flag['jushen']" type="button" class="btn btn-info btn-bloc" (click)="cancelVerify(0)">拒审</button>
    <button type="button" *ngIf="flag['verify']" class="btn btn-info btn-bloc" (click)="verifys()">审核</button>-->
    <button *ngIf="flag['cancelverify']" type="button" class="btn btn-info btn-bloc"
      (click)="cancelVerify(1)">弃审</button>
    <button type="button" class="btn btn-info btn-bloc" (click)="cancelVerify(2)">取消订单</button>
    <button *ngIf="proorder['status'] | print" type="button" class="btn btn-info btn-bloc"
      (click)="print()">打印预览</button>
    <span *NgOpera="242">
      <button *ngIf="proorder['status'] | print" type="button" class="btn btn-info btn-bloc"
        (click)="ordermodalchangeshow()">重新生成PDF</button>
    </span>
    <button class="btn btn-info btn-bloc" style="background-color:red;border-color:red;color:#ffffff;" type="button"
    (click)="deleteproorderdetfee()">货物明细批量删除</button>
  </div>
</div>

<div class="panel panel-default wis-auto">
  <!-- <legend></legend>   -->
  <div class="row fieldsetdnn">
    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 form-control-static">买方单位:</div>
        <div class="col-md-8 col-xs-6 form-control-static">{{proorder['buyer']?proorder['buyer']['name']:''}}</div>
      </div>
    </div>

    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 form-control-static">卖方单位:</div>
        <div class="col-md-8 col-xs-6 form-control-static">{{proorder['seller']?proorder['seller']['name']:''}}</div>
      </div>
    </div>

    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 control-label form-control-static">总重量:</div>
        <div class="col-md-8 col-xs-6 form-control-static">
          {{proorder['tweight']}}吨
        </div>
      </div>
    </div>

    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 control-label form-control-static">总金额:</div>
        <div class="col-md-8 col-xs-6 form-control-static">
          {{proorder['tjine']}}元
        </div>
      </div>
    </div>
  </div>

  <div class="row fieldsetdnn">
    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 control-label form-control-static">订单状态:</div>
        <div class="col-md-8 col-xs-6 form-control-static">{{proorder['status']| orderstatus:proorder['isonline']}}
        </div>
      </div>
    </div>

    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 control-label form-control-static">运送类型:</div>
        <div class="col-md-8 col-xs-6 form-control-static">{{proorder['type']| transporttype}}</div>
      </div>
    </div>

    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 control-label form-control-static">是否审核:</div>
        <div class="col-md-8 col-xs-6 form-control-static">
          {{proorder['isv']?'是':'否'}}
        </div>
      </div>
    </div>

    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 control-label form-control-static">审核人:</div>
        <div class="col-md-8 col-xs-6 form-control-static">
          {{proorder['vuser']?proorder['vuser']['realname']:''}}
        </div>
      </div>
    </div>

  </div>

  <div class="row fieldsetdnn">
    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 control-label form-control-static">订单编号:</div>
        <div class="col-md-8 col-xs-6 form-control-static">
          {{proorder['billno']}}
        </div>
      </div>
    </div>

    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 control-label form-control-static">制单人:</div>
        <div class="col-md-8 col-xs-6 form-control-static">
          {{proorder | agentuser}}
        </div>
      </div>
    </div>

    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 control-label form-control-static">下单时间:</div>
        <div class="col-md-8 col-xs-6 form-control-static">
          {{proorder['cdate']}}
        </div>
      </div>
    </div>

    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 control-label form-control-static">版本号:</div>
        <div class="col-md-8 col-xs-6 form-control-static">
          {{proorder['version']}}
        </div>
      </div>
    </div>
  </div>

  <div class="row fieldsetdnn">
    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 control-label form-control-static">出库费类型:</div>
        <div class="col-md-8 col-xs-6 form-control-static">
          免付
        </div>
      </div>
    </div>

    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 control-label form-control-static">出库费价格:</div>
        <div class="col-md-8 col-xs-6 form-control-static">
          0
        </div>
      </div>
    </div>
    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 control-label form-control-static">实付配款:</div>
        <div class="col-md-8 col-xs-6 form-control-static">
          {{proorder['allocation']}}
        </div>
      </div>
    </div>
    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 control-label form-control-static">备注:</div>
        <div class="col-md-8 col-xs-6 form-control-static">
          <input type="text" placeholder="请输入备注" class="form-control" [(ngModel)]="proorder['beizhu']"
            [disabled]="proorder['status'] | editable" />
        </div>
      </div>
    </div>
  </div>
  <div class="row fieldsetdnn">
    <div class="col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 control-label form-control-static">是否处理质量异议:</div>
        <div class="col-md-8 col-xs-6 form-control-static">
          {{proorder['ischuliquality']?'是':'否'}}
        </div>
      </div>
    </div>
    <div *ngIf="proorder['ischuliquality']" class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 control-label form-control-static">质量异议单号:</div>
        <div class="col-md-8 col-xs-6 form-control-static">
          {{proorder['zhiliangyiyibillno']}}
        </div>
      </div>
    </div>
    <div *ngIf="proorder['ischuliquality']" class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 control-label form-control-static">说明:</div>
        <div class="col-md-8 col-xs-6 form-control-static">
          {{proorder['salebeizhu']}}
        </div>
      </div>
    </div>
    <div *ngIf="proorder['ischuliquality']" class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 control-label form-control-static">赔付金额:</div>
        <div class="col-md-8 col-xs-6 form-control-static">
          {{proorder['salejine']}}
        </div>
      </div>
    </div>
  </div>
  <div class="row fieldsetdnn" *ngIf="proorder['type'] == 1">
    <div class=" col-lg-6 col-md-6 ">
      <div class="row">
        <div class="col-md-2 col-xs-6 control-label form-control-static">收货地址:</div>
        <div class="col-md-10 col-xs-6 form-control-static">
          {{(proorder['addrbak']['province'] ? proorder['addrbak']['province'] : '') +
          (proorder['addrbak']['city'] ? proorder['addrbak']['city'] : '') +
          (proorder['addrbak']['county']
          ? proorder['addrbak']['county'] :'') + proorder['addrbak']['detail']}}
        </div>
      </div>
    </div>
  </div>

  <!-- 标签 -->
  <p-tabView [style]="{'padding-top': '3px'}">
    <p-tabPanel header="成品明细单"
      [headerStyle]="{'background-color': '#fff', 'border-color': '#ccc','border-bottom-color': 'rgba(0, 0, 0, 0)','margin-left': '5px'}">
      <ag-grid-angular [ngStyle]="{'height': (settings.bodyHeight - 443)+'px'}" #agGrid
        style="width: calc(100% + 22px);height:100%;margin:0 -11px;margin-top:-5px;" class="ag-blue"
        [gridOptions]="gridOptions1">
      </ag-grid-angular>
    </p-tabPanel>
    <p-tabPanel header="基料明细单" [headerStyle]="{'background-color': '#fff', 'border-color': '#ccc',color: '#ddd'}">
      <ag-grid-angular [ngStyle]="{'height': (settings.bodyHeight - 443)+'px'}" #feeagGrid
        style="width: calc(100% + 22px);height:100%;margin:0 -11px;margin-top:-5px;" class="ag-blue"
        [gridOptions]="gridOptions">
      </ag-grid-angular>
    </p-tabPanel>
    <p-tabPanel header="物流竞价明细" [headerStyle]="{'background-color': '#fff', 'border-color': '#ccc',color: '#ddd'}">
      <ag-grid-angular [ngStyle]="{'height': (settings.bodyHeight - 443)+'px'}" #feeagGrid
        style="width: calc(100% + 22px);height:100%;margin:0 -11px;margin-top:-5px;" class="ag-blue"
        [gridOptions]="wuliuOffergridOptions">
      </ag-grid-angular>
    </p-tabPanel>
    <p-tabPanel header="配款明细" [headerStyle]="{'background-color': '#fff', 'border-color': '#ccc',color: '#ddd'}">
      <ag-grid-angular [ngStyle]="{'height': (settings.bodyHeight - 443)+'px'}" #agGrid
        style="width: calc(100% + 22px);height:100%;margin:0 -11px;margin-top:-5px;" class="ag-blue"
        [gridOptions]="allocationgridOptions">
      </ag-grid-angular>
    </p-tabPanel>
  </p-tabView>


  <toaster-container></toaster-container>


  <!--添加成品弹窗-->
  <div class="modal" bsModal #addProModal="bs-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
    aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" aria-label="Close" (click)="hideaddProModal()">
            <span aria-hidden="true">&times;</span>
          </button>
          <h4 class="modal-title">添加成品</h4>
        </div>
        <div class="modal-body">
          <div class="panel panel-default">
            <div class="panel-body">

              <div class="form-group mb fieldsetdnn col-sm-6">
                <label class="col-sm-4 control-label">宽度:</label>
                <div class="col-sm-8">
                  <input class="form-control" type="text" [(ngModel)]="requestparams['width']" placeholder="请输入加工宽度" />
                </div>
              </div>

              <div class="form-group mb fieldsetdnn col-sm-6">
                <label class="col-sm-4 control-label">长度:</label>
                <div class="col-sm-8" style="padding-top:1px;padding-bottom:1px;">
                  <input class="form-control" type="text" [(ngModel)]="requestparams['length']" placeholder="请输入加工长度" />
                </div>
              </div>

              <div class="form-group mb fieldsetdnn col-sm-6">
                <label class="col-sm-4 control-label">重量:</label>
                <div class="col-sm-8" style="padding-top:1px;padding-bottom:1px;">
                  <input type="text" placeholder="请输入货物重量" [(ngModel)]="requestparams['weight']" class="form-control" />
                </div>
              </div>

              <div class="form-group mb fieldsetdnn col-sm-6">
                <label class="col-sm-4 control-label">定价:</label>
                <div class="col-sm-8" style="padding-top:1px;padding-bottom:1px;">
                  <input type="text" placeholder="请输入货物定价" [(ngModel)]="requestparams['price']" class="form-control"
                    disabled />
                </div>
              </div>

              <div class="form-group mb fieldsetdnn col-sm-6">
                <label class="col-sm-4 control-label">销售价:</label>
                <div class="col-sm-5" style="padding-top:1px;padding-bottom:1px;">
                  <input type="text" placeholder="请输入销售价" [(ngModel)]="requestparams['pertprice']" class="form-control"
                    disabled />
                </div>
                <div class="col-sm-3">
                  <button type="button" (click)="feeadddialogshow()" class="btn btn-info btn-large">添加</button>
                </div>
              </div>

            </div>
          </div>
          <div class="form-inline text-center">
            <button type="button" (click)="addproductdet()" class="btn btn-primary btn-large">提交</button>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!--价格/费用添加弹出窗口-->
  <div class="modal" bsModal #feeadddialog="bs-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
    aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <button class="close" type="button" aria-label="Close" (click)="feeadddialogclose()">
            <span aria-hidden="true">&times;</span>
          </button>
          <h4 class="modal-title pull-left">价格/费用添加</h4>
        </div>

        <div class="modal-body">
          <div class="panel panel-default">
            <div class="panel-body">

              <div class="row">
                <div class="col-md-3 col-sm-3  text-center">
                  <label class="col-sm-12 control-label form-control-static">销售单价</label>
                </div>
                <div class="col-md-1 col-sm-1  text-center">
                  <label class="col-sm-12 control-label">-</label>
                </div>
                <div class="col-md-2 col-sm-2  text-center">
                  <label class="col-sm-12 control-label form-control-static">定价</label>
                </div>
                <div class="col-md-1 col-sm-1  text-center">
                  <label class="col-sm-12 control-label">-</label>
                </div>
                <div class="col-md-2 col-sm-2  text-center">
                  <label class="col-sm-12 control-label form-control-static">费用合计单价</label>
                </div>
                <div class="col-md-1 col-sm-1 text-center">
                  <label class="col-sm-12 control-label">=</label>
                </div>
                <div class="col-md-2 col-sm-2 text-center">
                  <label class="col-sm-12 control-label form-control-static">预估毛利</label>
                </div>
              </div>

              <div class="row">
                <div class="col-md-3 col-sm-3 text-center">
                  <input style="text-align:center" [(ngModel)]="requestparams['pertprice']" class="form-control"
                    placeholder="请输入销售价格" required>
                </div>
                <div class="col-md-1 col-sm-1  text-center">
                  -
                </div>
                <div class="col-md-2 col-sm-2 text-center">
                  <input style="text-align:center" [(ngModel)]="requestparams['price']" class="form-control"
                    placeholder="请输入内部结算价" required>
                </div>
                <div class="col-md-1 col-sm-1 text-center">
                  -
                </div>
                <div class="col-md-2 col-sm-2 text-center">
                  {{feeHeji}}
                </div>
                <div class="col-md-1 col-sm-1 text-center">
                  =
                </div>
                <div class="col-md-2 col-sm-2 text-center">
                  {{requestparams['pertprice'] - requestparams['price'] - feeHeji}}
                </div>
              </div>

              <div class="form-group mb fieldsetdnn col-sm-12 col-md-12"></div>

              <div class="row">
                <div class="col-sm-3 text-center">
                  <label class="col-sm-12 control-label form-control-static">费用类型</label>
                </div>
                <div class="col-sm-3 text-center">
                  <label class="col-sm-12 control-label form-control-static">单价</label>
                </div>
                <div class="col-sm-3 text-center">
                  <label class="col-sm-12 control-label form-control-static">备注</label>
                </div>
                <div class="col-sm-3 text-center">
                  <label class="col-sm-12 control-label form-control-static">
                    <span *ngIf="!isshowInput" class="label label-info" (click)="showInput()">插入费用</span>
                    <span *ngIf="isshowInput" class="label label-info" (click)="showInput()">取消插入</span>
                  </label>
                </div>
              </div>

              <div class="row" *ngIf="isshowInput">
                <div class="col-sm-3">
                  <p-dropdown [options]="feetypes" [(ngModel)]="feemodel['feetype']" placeholder="选择费用类型"
                    [style]="{'width': 'calc(100% - 30px)','margin': '0 15px'}">
                  </p-dropdown>
                </div>
                <div class="col-sm-3">
                  <input style="width:calc(100% - 30px); margin: 0 15px" class="form-control"
                    [(ngModel)]="feemodel['price']" placeholder="请输入费用单价" required>
                </div>
                <div class="col-sm-3">
                  <input style="width:calc(100% - 30px); margin: 0 15px" class="form-control"
                    [(ngModel)]="feemodel['beizhu']" placeholder="请输入备注" required>
                </div>
                <div class="col-sm-3 text-center">
                  <button type="button" (click)="insertline()" class="btn btn-primary btn-large">插入费用</button>
                </div>
              </div>

              <div class="row fieldsetdnn" *ngFor="let item of lines;index as i;">
                <div class="col-sm-3 text-center">
                  <span>{{item.feetype|feetype}}</span>
                </div>
                <div class="col-sm-3 text-center">
                  <span>{{item.feeprice}}</span>
                </div>
                <div class="col-sm-3 text-center">
                  <span>{{item.beizhu}}</span>
                </div>
                <div class="col-sm-3 text-center">
                  <span style="padding-left: 80px" (click)="delorderfee(i,item.feeprice)">
                    <a>删除</a>
                  </span>
                </div>
              </div>

            </div>
          </div>
        </div>
        <div class="modal-footer">
          <div class="form-inline text-center">
            <div class="form-inline text-center">
              <button type="button" (click)="feeadddialogclose()" class="btn btn-primary btn-large">确定</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!--价格/费用修改弹出窗口-->
  <div class="modal" bsModal #feemodifydialog="bs-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
    aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <button class="close" type="button" aria-label="Close" (click)="feemodifydialogclose()">
            <span aria-hidden="true">&times;</span>
          </button>
          <h4 class="modal-title pull-left">价格/费用修改</h4>
        </div>

        <div class="modal-body">
          <div class="panel panel-default">
            <div class="panel-body">

              <div class="row">
                <div class="col-md-3 col-sm-3  text-center">
                  <label class="col-sm-12 control-label form-control-static">销售单价</label>
                </div>
                <div class="col-md-1 col-sm-1  text-center">
                  <label class="col-sm-12 control-label">-</label>
                </div>
                <div class="col-md-2 col-sm-2  text-center">
                  <label class="col-sm-12 control-label form-control-static">定价</label>
                </div>
                <div class="col-md-1 col-sm-1  text-center">
                  <label class="col-sm-12 control-label">-</label>
                </div>
                <div class="col-md-2 col-sm-2  text-center">
                  <label class="col-sm-12 control-label form-control-static">费用合计单价</label>
                </div>
                <div class="col-md-1 col-sm-1 text-center">
                  <label class="col-sm-12 control-label">=</label>
                </div>
                <div class="col-md-2 col-sm-2 text-center">
                  <label class="col-sm-12 control-label form-control-static">预估毛利</label>
                </div>
              </div>

              <div class="row">
                <div class="col-md-3 col-sm-3 text-center">
                  <input style="text-align:center" [(ngModel)]="requestparams['pertprice']" class="form-control"
                    placeholder="请输入销售价格" disabled required>
                </div>
                <div class="col-md-1 col-sm-1  text-center">
                  -
                </div>
                <div class="col-md-2 col-sm-2 text-center">
                  <input style="text-align:center" [(ngModel)]="requestparams['price']" class="form-control"
                    placeholder="请输入内部结算价" disabled required>
                </div>
                <div class="col-md-1 col-sm-1 text-center">
                  -
                </div>
                <div class="col-md-2 col-sm-2 text-center">
                  {{feeHeji}}
                </div>
                <div class="col-md-1 col-sm-1 text-center">
                  =
                </div>
                <div class="col-md-2 col-sm-2 text-center">
                  {{requestparams['pertprice'] - requestparams['price'] - feeHeji}}
                </div>
              </div>

              <div class="form-group mb fieldsetdnn col-sm-12 col-md-12"></div>

              <div class="row">
                <div class="col-sm-3 text-center">
                  <label class="col-sm-12 control-label form-control-static">费用类型</label>
                </div>
                <div class="col-sm-3 text-center">
                  <label class="col-sm-12 control-label form-control-static">单价</label>
                </div>
                <div class="col-sm-3 text-center">
                  <label class="col-sm-12 control-label form-control-static">备注</label>
                </div>
                <div class="col-sm-3 text-center">
                  <label class="col-sm-12 control-label form-control-static">
                    <span *ngIf="!isshowInput" class="label label-info" (click)="showInput()">插入费用</span>
                    <span *ngIf="isshowInput" class="label label-info" (click)="showInput()">取消插入</span>
                  </label>
                </div>
              </div>

              <div class="row" *ngIf="isshowInput">
                <div class="col-sm-3">
                  <p-dropdown [options]="feetypes" [(ngModel)]="feemodel['feetype']" placeholder="选择费用类型"
                    [style]="{'width': 'calc(100% - 30px)','margin': '0 15px'}">
                  </p-dropdown>
                </div>
                <div class="col-sm-3">
                  <input style="width:calc(100% - 30px); margin: 0 15px" class="form-control"
                    [(ngModel)]="feemodel['price']" placeholder="请输入费用单价" required>
                </div>
                <div class="col-sm-3">
                  <input style="width:calc(100% - 30px); margin: 0 15px" class="form-control"
                    [(ngModel)]="feemodel['beizhu']" placeholder="请输入备注" required>
                </div>
                <div class="col-sm-3 text-center">
                  <button type="button" (click)="modifyfee()" class="btn btn-primary btn-large">插入费用</button>
                </div>
              </div>

              <div class="row fieldsetdnn" *ngFor="let item of lines;index as i;">
                <div class="col-sm-3 text-center">
                  <span>{{item.feetype|feetype}}</span>
                </div>
                <div class="col-sm-3 text-center">
                  <span>{{item.feeprice}}</span>
                </div>
                <div class="col-sm-3 text-center">
                  <span>{{item.beizhu}}</span>
                </div>
                <div class="col-sm-3 text-center">
                  <span style="padding-left: 80px" (click)="delfeeindb(item.id,item.collectid,item.feeprice)">
                    <a>删除</a>
                  </span>
                </div>
              </div>

            </div>
          </div>
        </div>
        <div class="modal-footer">
          <div class="form-inline text-center">
            <div class="form-inline text-center">
              <button type="button" (click)="feemodifydialogclose()" class="btn btn-primary btn-large">确定</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- 添加配款 -->
  <div class="modal" bsModal #allocationModel="bs-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-xs">
    <div class="modal-content">
      <div class="modal-header">
        <button class="close" type="button" aria-label="Close" (click)="closeallocationdialog()">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title">添加配款</h4>
      </div>
      <div class="modal-body">
        <div class="panel panel-default">
          <div class="panel-body">

            <div class="form-group mb fieldsetdnn row">
              <label class="col-sm-3 control-label">
                <span style="float: right;">账户余额：</span>
              </label>
              <div class="col-sm-9">
                {{curyue}}
              </div>
            </div>
            <div class="form-group mb fieldsetdnn row">
              <label class="col-sm-4 control-label">
                <span style="float: right;">剩余需配款金额：</span>
              </label>
              <div class="col-sm-8">
                {{xuyue}}
              </div>
            </div>
            <div class="form-group mb fieldsetdnn row">
              <label class="col-sm-3 control-label">
                <span style="float: right;">实付货款：</span>
              </label>
              <div class="col-sm-9">
                <input [(ngModel)]="allocation['jine']" class="form-control" placeholder="请输入实付定金" required>
              </div>
            </div>

          </div>
        </div>
      </div>
      <div class="form-inline text-center">
        <button type="button" (click)="addallocation()" class="btn btn-primary btn-large">添加</button>
      </div>
    </div>
  </div>
</div>
<!--释放实付定金-->
<div class="modal" bsModal #shifangallocationModel="bs-modal" tabindex="-1" role="dialog"
  aria-labelledby="mySmallModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-xs">
    <div class="modal-content">
      <div class="modal-header">
        <button class="close" type="button" aria-label="Close" (click)="closeshifangallocationdialog()">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title">释放货款</h4>
      </div>
      <div class="modal-body">
        <div class="panel panel-default">
          <div class="panel-body">

            <div class="form-group mb fieldsetdnn row">
              <label class="col-sm-3 control-label">
                <span style="float: right;">实付货款：</span>
              </label>
              <div class="col-sm-9">
                {{proorder['allocation']}}
              </div>
            </div>
            <div class="form-group mb fieldsetdnn row">
              <label class="col-sm-3 control-label">
                <span style="float: right;">释放货款：</span>
              </label>
              <div class="col-sm-9">
                <input [(ngModel)]="allocation['jine']" class="form-control" placeholder="请输入释放定金金额" required>
              </div>
            </div>
            <div class="form-group mb fieldsetdnn row">
              <label class="col-sm-3 control-label">
                <span style="float: right;">释放原因：</span>
              </label>
              <div class="col-sm-9">
                <input [(ngModel)]="allocation['reason']" class="form-control" placeholder="请输入释放配款原因" required>
              </div>
            </div>

          </div>
        </div>
      </div>
      <div class="form-inline text-center">
        <button type="button" (click)="shifangAllocation()" class="btn btn-primary btn-large">释放</button>
      </div>
    </div>
  </div>
</div>
<!-- 修改主表信息 -->
<div class="modal" bsModal #mainmodifydialog="bs-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-xs">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" aria-label="Close" (click)="closemaindialog()">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title">修改</h4>
      </div>
      <div class="modal-body">
        <div class="panel panel-default">
          <div class="panel-body">
            <div class="form-group mb fieldsetdnn row">
              <label class="col-sm-3 control-label">配送方式:</label>
              <div class="col-sm-9">
                <label class="radio-inline c-radio">
                  <input id="inlineradio1" type="radio" name="i-radio" [value]="0" [(ngModel)]="editorder['type']" />
                  <span class="fa fa-circle"></span>自提
                </label>
                <label class="radio-inline c-radio">
                  <input id="inlineradio2" type="radio" name="i-radio" [value]="1" [(ngModel)]="editorder['type']"
                    (ngModelChange)="getAddr()" />
                  <span class="fa fa-circle"></span>代运
                </label>
                <label class="radio-inline c-radio">
                  <input id="inlineradio3" type="radio" name="i-radio" [value]="2" [(ngModel)]="editorder['type']" />
                  <span class="fa fa-circle"></span>转货
                </label>
              </div>
            </div>
            <div class="form-group mb fieldsetdnn row">
              <label class="col-sm-3 control-label">收货地址:</label>
              <div class="col-sm-7">
                <p-dropdown [options]="addrs" [(ngModel)]="editorder['addrid']" [style]="{'width':'100%'}"
                  [filter]="true" filterBy="label,value.name">
                </p-dropdown>
              </div>
              <div class="col-sm-2">
                <span class="input-group-btn">
                  <button type="button" class="btn btn-default" (click)="addAddrDialog()">
                    <i class="fa fa-plus"></i>
                  </button>
                </span>
              </div>
            </div>
          </div>
        </div>
        <div class="form-inline text-center">
          <button type="button" (click)="modifymain()" class="btn btn-primary btn-large">修改</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!--添加地址弹窗-->
<div class="modal" bsModal #addrdialog="bs-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-md">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" aria-label="Close" (click)="addrdialogclose()">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title">添加地址</h4>
      </div>
      <div class="modal-body">
        <div class="panel panel-default">
          <div class="panel-body">
            <div class="form-group mb fieldsetdnn col-sm-12 ">
              <label class="col-sm-3 control-label">地址：</label>
              <div class="col-sm-9">
                <p-dropdown [options]="provinces" [(ngModel)]="addr['provinceid']"
                  [style]="{'width':'100%','font-size':'15px'}" (onChange)="getcity()" [placeholder]="'请选择省份'">
                </p-dropdown>
              </div>
            </div>
            <div class="form-group mb fieldsetdnn col-sm-12">
              <label class="col-sm-3 control-label"></label>
              <div class="col-sm-9">
                <p-dropdown [options]="citys" [(ngModel)]="addr['cityid']" [style]="{'width':'100%','font-size':'15px'}"
                  (onChange)="getcounty()" [placeholder]="'请选择市'">
                </p-dropdown>
              </div>
            </div>
            <div class="form-group mb fieldsetdnn col-sm-12">
              <label class="col-sm-3 control-label"></label>
              <div class="col-sm-9">
                <p-dropdown [options]="countys" [(ngModel)]="addr['countyid']"
                  [style]="{'width':'100%','font-size':'15px'}" [placeholder]="'请选择县/区'"></p-dropdown>
              </div>
            </div>
            <div class="form-group mb fieldsetdnn col-sm-12 ">
              <label class="col-sm-3 control-label">详细地址：</label>
              <div class="col-sm-9">
                <input type="text" placeholder="请输入详细地址" [(ngModel)]="addr['detail']" class="form-control" required />
              </div>
            </div>
            <div class="form-group mb fieldsetdnn col-sm-12 ">
              <label class="col-sm-3 control-label">联系人：</label>
              <div class="col-sm-9">
                <input type="text" placeholder="请输入联系人" [(ngModel)]="addr['lianxiren']" class="form-control" required />
              </div>
            </div>
            <div class="form-group mb fieldsetdnn col-sm-12 ">
              <label class="col-sm-3 control-label">联系方式：</label>
              <div class="col-sm-9">
                <input type="text" placeholder="请输入联系方式" [(ngModel)]="addr['phone']" class="form-control" required />
              </div>
            </div>
          </div>
        </div>
        <div class="form-inline text-center">
          <button type="button" (click)="addAddr()" class="btn btn-primary btn-large">添加</button>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- 修改定价 -->
<div class="modal" bsModal #priceDialog="bs-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-xs">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" aria-label="Close" (click)="pricehideDialog()">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title">修改</h4>
      </div>
      <div class="modal-body">
        <div class="panel panel-default">
          <div class="panel-body">
            <div class="form-group mb fieldsetdnn col-sm-12 col-md-12">
              <label class="col-sm-3 control-label">定价</label>
              <div class="col-sm-9">
                <input type="number" class="form-control" [(ngModel)]="modifyprice['price']" />
              </div>
            </div>
          </div>
        </div>
        <div class="form-inline text-center">
          <button type="button" (click)="modifydingjiaprice()" class="btn btn-primary btn-large">修改</button>
        </div>
      </div>
    </div>
  </div>
</div>
<!--添加弹窗-->
<div class="modal" bsModal #addqualityModal="bs-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-md">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" aria-label="Close" (click)="hideaddModal()">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title">添加</h4>
      </div>
      <div class="modal-body">
        <div class="form-group mb fieldsetdnn col-sm-12 col-md-12">
          <label class="col-sm-3 control-label">是否需要在本订单中处理前期已提报尚未处理的质量异议</label>
          <div class="col-sm-9">
            <label class="radio-inline c-radio">
              <input id="inlineradio1" type="radio" name="ischuliquality-radio" [value]="1" [(ngModel)]="qualityModel['ischuliquality']" />
              <span class="fa fa-circle"></span>是
            </label>
            <label class="radio-inline c-radio">
              <input id="inlineradio2" type="radio" name="ischuliquality-radio" [value]="0" [(ngModel)]="qualityModel['ischuliquality']" />
              <span class="fa fa-circle"></span>否
            </label>
            <span style="color: red;">*必选项，如果选择是，则提交审核后触发审批</span>
          </div>
        </div>
        <div *ngIf="qualityModel['ischuliquality'] === 1" class="form-group mb fieldsetdnn row">
          <label class="col-sm-3 control-label required">处理类型</label>
          <div class="col-sm-9">
            <p-dropdown [options]="saletypes" placeholder="选择处理类型" [(ngModel)]="qualityModel['saletype']"  [style]="{'width': '100%'}">
            </p-dropdown>
          </div>
        </div>
        <div *ngIf="qualityModel['ischuliquality'] === 1" class="form-group mb fieldsetdnn col-sm-12 col-md-12">
          <label class="col-sm-3 control-label">说明</label>
          <div class="col-sm-9">
            <input type="text" [(ngModel)]="qualityModel['salebeizhu']" class="form-control" />
          </div>
        </div>
        <div *ngIf="qualityModel['ischuliquality'] === 1" class="form-group mb fieldsetdnn col-sm-12 col-md-12">
          <label class="col-sm-3 control-label">赔付金额</label>
          <div class="col-sm-9">
            <input type="text" [(ngModel)]="qualityModel['salejine']" class="form-control" />
          </div>
        </div>
        <div class="form-inline text-center">
          <button *ngIf="qualityModel['ischuliquality'] === 1" type="button" (click)="choice()" class="btn btn-primary btn-large">选择质量异议</button>
          <button *ngIf="qualityModel['ischuliquality'] !== 1" type="button" (click)="addupdate()" class="btn btn-primary btn-large">提交</button>
        </div>
      </div>
    </div>
  </div>
</div>
<!--  选择模板的弹窗 -->
<div class="modal" bsModal #ordermodalchange="bs-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
aria-hidden="true">
  <div class="modal-dialog modal-xs">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" aria-label="Close" (click)="hideordermodalchange()">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title">模板选择</h4>
      </div>
      <div class="modal-body">
        <div class="panel panel-default">
          <div class="panel-body">
            <div class="col-sm-9">
              <p-dropdown [options]="ordermodal" placeholder="选择模板" [(ngModel)]="changeordermodal['ordermodal']"  [style]="{'width': '100%'}">
              </p-dropdown>
            </div>
            <div class="form-inline text-center">
              <button type="button" (click)="reload()" class="btn btn-primary btn-large">确定打印</button>
            </div>
       <!--      <div class="row fieldsetdnn">
              &emsp;&emsp;&emsp;&emsp;&emsp;
              <button  type="button" (click)="makepdf()" class="btn btn-info btn-large">默认模板</button>
              &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;
              <button  type="button"  (click)="makepdf()" class=" btn btn-info btn-large">老模板</button>              
            </div> -->
          </div>
        </div>
      </div>
    </div> 
  </div>
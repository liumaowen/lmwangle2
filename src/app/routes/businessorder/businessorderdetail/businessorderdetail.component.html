<div class="content-heading">
  <em class="fa fa-book"></em> 线下订单
  <div class="pull-right  wide-show">
    <button *ngIf="isshowzhibaoshu" type="button" (click)="makezhibaoshu()" class="btn btn-info btn-sm margin-top-bottom-25">生成质保书</button>
    <button *ngIf="flag['submitV']&&businessorder['isself']" type="button" (click)="qualitShow()" class="btn btn-info btn-sm margin-top-bottom-25">质量异议</button>
    <button type="button" (click)="openmodifymain()" class="btn btn-info btn-sm margin-top-bottom-25">修改订单</button>
    <button *ngIf="flag['isorderchange']" type="button" (click)="orderchange()" class="btn btn-info btn-sm margin-top-bottom-25" style="background-color:red;border-color:red;color:#ffffff;">{{flag['qihuochangestatus'] === 0?'合同变更':'变更提交'}}</button>
    <button type="button" (click)="shownoticewuliuyuan()"
      class="btn btn-info btn-sm margin-top-bottom-25">通知物流专员</button>
    <button type="button" (click)="getZhibaoUrl()" class="btn btn-info btn-sm margin-top-bottom-25">查看质保书</button>
    <button *ngIf="flag['fin']" type="button" (click)="finish(businessorder['id'],businessorder['version'])"
      class="btn btn-sm margin-top-bottom-25" style="background-color:#FF7F24;border-color:#FF7F24;color:#ffffff;">
      <span *ngIf="businessorder['isself']">完成确认</span>
      <span *ngIf="!businessorder['isself']">合同撤销</span>
    </button>
    <button *ngIf="flag['del']" type="button" (click)="delbusinessorder(businessorder['id'])"
      class="btn btn-sm margin-top-bottom-25" style="background-color:red;border-color:red;color:#ffffff;">删除订单
    </button>
    <button *ngIf="flag['cancels']" type="button" (click)="cancelbusinessorder(businessorder)"
      class="btn btn-info btn-sm margin-top-bottom-25">取消订单
    </button>
    <button type="button" [disabled]="!flag['isxianhuoself']" (click)="addallocationdialog()"
      class="btn btn-info btn-sm margin-top-bottom-25">配款
    </button>
    <button type="button" [disabled]="!flag['isxianhuoself']" (click)="shifangallocationdialog()"
      class="btn btn-info btn-sm margin-top-bottom-25">释放配款
    </button>
    <button *ngIf="flag['import']" type="button" (click)="importKucun()"
      class="btn btn-info btn-sm margin-top-bottom-25">引入库存</button>
    <button *ngIf="flag['import']" type="button" (click)="importFav()"
      class="btn btn-info btn-sm margin-top-bottom-25">引入收藏夹</button>
    <button *ngIf="flag['submitV']" type="button" (click)="submitVerify()"
      class="btn btn-info btn-sm margin-top-bottom-25">提交审核</button>
    <!-- <button *ngIf="flag['verify']" type="button" (click)="refuseverify()"
      class="btn btn-info btn-sm margin-top-bottom-25">拒审</button>
    <button *ngIf="flag['verify']" type="button" (click)="Verify()"
      class="btn btn-info btn-sm margin-top-bottom-25">审核</button> -->
    <button *ngIf="flag['cancelverify']" type="button" (click)="cancelVerify()"
      class="btn btn-info btn-sm margin-top-bottom-25">弃审</button>
    <button *ngIf="flag['pay']&& businessorder['status'] !== 9" type="button" (click)="payorderDialog()"
      class="btn btn-info btn-sm margin-top-bottom-25">支付</button>
    <button *ngIf="businessorder['status'] | isprint" type="button" (click)="print()"
      class="btn btn-info btn-sm margin-top-bottom-25">打印预览</button>
    <!-- <span *NgOpera="242"> -->
    <button *ngIf="businessorder['status'] | isprint" type="button" (click)="ordermodalchangeshow()"
      class="btn btn-info btn-sm margin-top-bottom-25">生成PDF</button>
    <!-- </span> -->
    <!-- <button *ngIf="flag['arrearspay']" type="button" (click)="arrearspay()" class="btn btn-info btn-sm margin-top-bottom-25">欠款支付</button> -->
    <button type="button" (click)="recalculate()" class="btn btn-info btn-sm margin-top-bottom-25">重新计算</button>
    <button class="btn btn-info btn-bloc" style="background-color:red;border-color:red;color:#ffffff;" type="button"
    (click)="deleteorderdet()">货物明细批量删除</button> 
  
  </div>
  <div class="pull-right narrow-show">
    <div class="btn-group" dropdown placement="bottom right">
      <button dropdownToggle type="button" class="btn btn-info dropdown-toggle">菜单
        <span class="caret"></span>
      </button>
      <ul *dropdownMenu class="dropdown-menu dropdown-menu-right" role="menu">
        <li role="menuitem">
          <a class="dropdown-item" (click)="openmodifymain()">修改订单</a>
        </li>
        <li class="divider dropdown-divider"></li>
        <!--<li *ngIf="flag['verify']" role="menuitem">
          <a class="dropdown-item" (click)="refuseverify()">拒审</a>
        </li>
        <li class="divider dropdown-divider"></li>
        <li *ngIf="flag['verify']" role="menuitem">
          <a class="dropdown-item" (click)="Verify()">审核</a>
        </li>
        <li class="divider dropdown-divider"></li>-->
        <li *ngIf="flag['cancelverify']" role="menuitem">
          <a class="dropdown-item" (click)="cancelVerify()">弃审</a>
        </li>
        <li class="divider dropdown-divider"></li>
        <li *ngIf="businessorder['status'] | isprint" role="menuitem">
          <a class="dropdown-item" (click)="print()">打印预览</a>
        </li>
        <li class="divider dropdown-divider" *NgOpera="109"></li>
        <li *ngIf="businessorder['status'] | isprint" role="menuitem">
          <a class="dropdown-item" (click)="ordermodalchangeshow()">生成PDF</a>
        </li>
        <li class="divider dropdown-divider"></li>
        <li *ngIf="flag['cancels']" role="menuitem">
          <a class="dropdown-item" (click)="cancelbusinessorder(businessorder)">取消订单</a>
        </li>
        <li class="divider dropdown-divider"></li>
        <li *ngIf="flag['fin']" role="menuitem">
          <a class="dropdown-item" (click)="finish(businessorder['id'],businessorder['version'])">
            <span *ngIf="businessorder['isself']">完成确认</span>
            <span *ngIf="!businessorder['isself']">合同撤销</span>
          </a>
        </li>
      </ul>
    </div>
  </div>

</div>

<div class="panel panel-default wis-auto" style="overflow:'auto'">
  <div class="row fieldsetdnn">
    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 form-control-static">买方单位:</div>
        <div class="col-md-8 col-xs-6 form-control-static">{{businessorder['buyer'] | customer}}</div>
      </div>
    </div>
    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 control-label form-control-static">卖方单位:</div>
        <div class="col-md-8 col-xs-6 form-control-static">
          {{businessorder['seller'] | customer}}
        </div>
      </div>
    </div>
    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 control-label form-control-static">总重量:</div>
        <div class="col-md-8 col-xs-6 form-control-static">
          {{businessorder['tweight']}}吨
        </div>
      </div>
    </div>
    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 control-label form-control-static">总长度:</div>
        <div class="col-md-8 col-xs-6 form-control-static">
          {{businessorder['tlength']}}米
        </div>
      </div>
    </div>
  </div>
  <div class="row fieldsetdnn">
    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 control-label form-control-static">运送类型:</div>
        <div class="col-md-8 col-xs-6 form-control-static">
          {{businessorder['type'] | orderyunshutype}}
        </div>
      </div>
    </div>
    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 control-label form-control-static">是否审核:</div>
        <div class="col-md-8 col-xs-6 form-control-static">
          {{businessorder['isv'] | isTranslated}}
        </div>
      </div>
    </div>
    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 control-label form-control-static">审核人:</div>
        <div class="col-md-8 col-xs-6 form-control-static">
          {{businessorder['vuser']?businessorder['vuser'].realname:''}}
        </div>
      </div>
    </div>
    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 control-label form-control-static">订单编号:</div>
        <div class="col-md-8 col-xs-6 form-control-static">
          {{businessorder['billno']}}
        </div>
      </div>
    </div>
  </div>
  <div class="row fieldsetdnn">
    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 control-label form-control-static">制单人:</div>
        <div class="col-md-8 col-xs-6 form-control-static">
          {{businessorder|agentuser}}
        </div>
      </div>
    </div>
    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 control-label form-control-static">下单时间:</div>
        <div class="col-md-8 col-xs-6 form-control-static">
          {{businessorder['cdate']}}-{{businessorder['version']}}
        </div>
      </div>
    </div>
    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 control-label form-control-static">金额:</div>
        <div class="col-md-8 col-xs-6 form-control-static">
          {{businessorder['tjine'] | number:"1.2-2"}}
        </div>
      </div>
    </div>
    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 control-label form-control-static">支付方式:</div>
        <div class="col-md-8 col-xs-6 form-control-static">
          {{businessorder | paytype}}
        </div>
      </div>
    </div>
  </div>
  <div class="row fieldsetdnn">
    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 control-label form-control-static">订单状态:</div>
        <div class="col-md-8 col-xs-6 form-control-static">
          {{businessorder['status'] | orderstatus:businessorder['isonline']}}
        </div>
      </div>
    </div>
    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 control-label form-control-static">实付配款:</div>
        <div class="col-md-8 col-xs-6 form-control-static">
          {{businessorder['allocation']}}
        </div>
      </div>
    </div>
    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 control-label form-control-static">备注:</div>
        <div class="col-md-8 col-xs-6 form-control-static">
          <input (blur)="save()" type="text" class="form-control" [(ngModel)]="businessorder['beizhu']"
            [disabled]="businessorder['status'] | editable" />
        </div>
      </div>
    </div>
    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 control-label form-control-static">订单类型:</div>
        <div class="col-md-8 col-xs-6 form-control-static">
          {{businessorder['isself']?'自销':'代销'}}
        </div>
      </div>
    </div>
  </div>
  <div class="row fieldsetdnn">
    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 control-label form-control-static">是否处理质量异议:</div>
        <div class="col-md-8 col-xs-6 form-control-static">
          {{businessorder['ischuliquality']?'是':'否'}}
        </div>
      </div>
    </div>
    <div *ngIf = "businessorder['ischuliquality']" class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 control-label form-control-static">质量异议单号:</div>
        <div class="col-md-8 col-xs-6 form-control-static">
          {{businessorder['zhiliangyiyibillno']}}
        </div>
      </div>
    </div>
    <div *ngIf = "businessorder['ischuliquality']" class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 control-label form-control-static">说明:</div>
        <div class="col-md-8 col-xs-6 form-control-static">
          {{businessorder['salebeizhu']}}
        </div>
      </div>
    </div>
    <div *ngIf = "businessorder['ischuliquality']" class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 control-label form-control-static">赔付金额:</div>
        <div class="col-md-8 col-xs-6 form-control-static">
          {{businessorder['salejine']}}
        </div>
      </div>
    </div>
  </div>
  <div class="row fieldsetdnn" *ngIf="businessorder['type'] == 1">
    <div class=" col-lg-6 col-md-6 ">
      <div class="row">
        <div class="col-md-2 col-xs-6 control-label form-control-static">收货地址:</div>
        <div class="col-md-10 col-xs-6 form-control-static">
          {{(businessorder['addrbak']['province'] ? businessorder['addrbak']['province'] : '') +
          (businessorder['addrbak']['city'] ? businessorder['addrbak']['city'] : '') +
          (businessorder['addrbak']['county']
          ? businessorder['addrbak']['county'] :'') + businessorder['addrbak']['detail']}}
        </div>
      </div>
    </div>
  </div>
  <div class="viewpanel">
    <p-tabView [style]="{'padding-top': '3px'}">
      <p-tabPanel header="现货明细"
        [headerStyle]="{'background-color': '#fff', 'border-color': '#ccc','border-bottom-color': 'rgba(0, 0, 0, 0)','margin-left': '5px'}">
        <ag-grid-angular [ngStyle]="{'height': (settings.bodyHeight - 409)+'px'}" #agGrid class="ag-blue"
          [gridOptions]="gridOptions" style="width: calc(100% + 22px);height:100%;margin:0 -11px;margin-top:-5px;">
        </ag-grid-angular>
      </p-tabPanel>
      <p-tabPanel header="加工基料明细"
        [headerStyle]="{'background-color': '#fff', 'border-color': '#ccc','border-bottom-color': 'rgba(0, 0, 0, 0)','margin-left': '5px'}">
        <ag-grid-angular [ngStyle]="{'height': (settings.bodyHeight - 409)+'px'}" #agGrid class="ag-blue"
          [gridOptions]="proordergridOptions"  style="width: calc(100% + 22px);height:100%;margin:0 -11px;margin-top:-5px;">
        </ag-grid-angular>
      </p-tabPanel>
      <p-tabPanel header="配款明细"
        [headerStyle]="{'background-color': '#fff', 'border-color': '#ccc','border-bottom-color': 'rgba(0, 0, 0, 0)','margin-left': '5px'}">
        <ag-grid-angular [ngStyle]="{'height': (settings.bodyHeight - 409)+'px'}" #agGrid class="ag-blue"
          [gridOptions]="allocationgridOptions"
          style="width: calc(100% + 22px);height:100%;margin:0 -11px;margin-top:-5px;">
        </ag-grid-angular>
      </p-tabPanel>
      <p-tabPanel header="物流竞价明细"
        [headerStyle]="{'background-color': '#fff', 'border-color': '#ccc','border-bottom-color': 'rgba(0, 0, 0, 0)','margin-left': '5px'}">
        <ag-grid-angular [ngStyle]="{'height': (settings.bodyHeight - 409)+'px'}" #agGrid class="ag-blue"
          [gridOptions]="wuliuOffergridOptions"
          style="width: calc(100% + 22px);height:100%;margin:0 -11px;margin-top:-5px;">
        </ag-grid-angular>
      </p-tabPanel>
      <p-tabPanel header="合同变更记录" [headerStyle]="{'background-color': '#fff', 'border-color': '#ccc','border-bottom-color': 'rgba(0, 0, 0, 0)','margin-left': '5px'}">
        <ag-grid-angular [ngStyle]="{'height': (settings.bodyHeight - 409)+'px'}" #agGrid
        style="width: calc(100% + 22px);height:100%;margin:0 -11px;margin-top:-5px;" class="ag-blue"
          [gridOptions]="orderchangegridOptions">
        </ag-grid-angular>
      </p-tabPanel>
    </p-tabView>
  </div>

</div>
<toaster-container></toaster-container>
<!--  添加费用的弹窗 -->
<!-- <div class="modal" bsModal #classicModal="bs-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-xs">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" aria-label="Close" (click)="hideDialog()">
                                    <span aria-hidden="true">&times;</span>
                                </button>
        <h4 class="modal-title">补差价格填写</h4>
      </div>
      <form [formGroup]="priceForm" class="form-validate mb-lg" role="form" name="loginForm" novalidate="">
        <div class="modal-body">
          <div class="panel panel-default">
            <div class="panel-body">
              <div class="form-group mb fieldsetdnn col-sm-12">
                <label class="col-sm-3 control-label">补差金额</label>
                <div class="col-sm-9">
                  <input type="number" formControlName="tprice" [(ngModel)]="sprice['tprice']" class="form-control" placeholder="请输入要补差的金额"
                  />
                  <span *ngIf="priceForm.controls['tprice'].hasError('required') && (priceForm.controls['tprice'].dirty || priceForm.controls['tprice'].touched)"
                    class="text-danger">请填写补差的金额</span>
                  <span *ngIf="priceForm.controls['tprice'].hasError('pattern') && (priceForm.controls['tprice'].dirty || priceForm.controls['tprice'].touched)"
                    class="text-danger">价格只能输入两位小数</span>
                </div>
              </div>
            </div>
          </div>

        </div>
        <div class="modal-footer">
          <div class="form-inline text-center">
            <div class="form-inline text-center">
              <button type="button" [disabled]="!priceForm['valid']" (click)="hideDialog()" class="btn btn-primary btn-large">确定</button>
            </div>
          </div>
        </div>
      </form>
    </div>
  </div>
</div> -->
<!--  出库费类型的弹窗 -->
<div class="modal" bsModal #chukufeetype="bs-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-xs">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" aria-label="Close" (click)="ckfeetypehideDialog()">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title">出库费类型</h4>
      </div>
      <div class="modal-body">
        <div class="panel panel-default" style="overflow:'inherit'">
          <div class="panel-body">
            <div class="form-group mb fieldsetdnn col-sm-12">
              <label class="col-sm-3 control-label">出库费类型</label>
              <div class="col-sm-9">
                <p-dropdown [options]="chukufeetypes" [(ngModel)]="chukufeetypess['value']" [style]="{'width':'100%'}"
                  [filter]="true" filterBy="label,value.name"></p-dropdown>
              </div>
            </div>
          </div>
        </div>

      </div>
      <div class="modal-footer">
        <div class="form-inline text-center">
          <div class="form-inline text-center">
            <button type="button" (click)="ckfeetypehideDialog()" class="btn btn-primary btn-large">确定</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<!--  运费的弹窗 -->
<div class="modal" bsModal #yunfeeDialog="bs-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-xs">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" aria-label="Close" (click)="yunfeehideDialog(yunfeemodel['yunfeeprice'])">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title">运费添加</h4>
      </div>
      <div class="modal-body">
        <div class="panel panel-default">
          <div class="panel-body">
            <form #yunfeeForm="ngForm">
              <div class="form-group mb fieldsetdnn col-sm-12">
                <label class="col-sm-3 control-label">运费单价</label>
                <div class="col-sm-9">
                  <input type="number" [(ngModel)]="yunfeemodel['yunfeeprice']" name="price" class="form-control"
                    placeholder="请输入运费" required ng-pattern="/^([0-9]+|[0-9]{1,3}(,[0-9]{3})*)(.[0-9]{1,2})?$/" />
                  <span
                    *ngIf="yunfeeForm.controls['price']?.errors?.pattern && yunfeeForm.controls['price']?.dirty || yunfeeForm.controls['price']?.touched"
                    class="text-danger">价格不能为负数且只能输入两位小数</span>
                </div>
              </div>
            </form>
          </div>
        </div>

      </div>
      <div class="modal-footer">
        <div class="form-inline text-center">
          <div class="form-inline text-center">
            <button type="button" (click)="yunfeehideDialog(yunfeemodel['yunfeeprice'])"
              class="btn btn-primary btn-large">确定</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<!--  加工费的弹窗 -->
<div class="modal" bsModal #jiagongfeeDialog="bs-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-xs">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" aria-label="Close" (click)="jiagongfeehideDialog()">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title">加工费添加</h4>
      </div>
      <div class="modal-body">
        <div class="panel panel-default">
          <div class="panel-body">
            <form #jiagongfeeForm="ngForm">
              <div class="form-group mb fieldsetdnn col-sm-12">
                <label class="col-sm-3 control-label">加工费单价</label>
                <div class="col-sm-9">
                  <input type="number" [(ngModel)]="jiagongfeemodel['jiagongfeeprice']" name="price"
                    class="form-control" placeholder="请输入加工费" required
                    ng-pattern="/^([0-9]+|[0-9]{1,3}(,[0-9]{3})*)(.[0-9]{1,2})?$/" />
                  <span
                    *ngIf="jiagongfeeForm.controls['price']?.errors?.pattern && jiagongfeeForm.controls['price']?.dirty || jiagongfeeForm.controls['price']?.touched"
                    class="text-danger">价格不能为负数且只能输入两位小数</span>
                </div>
              </div>
            </form>
          </div>
        </div>

      </div>
      <div class="modal-footer">
        <div class="form-inline text-center">
          <div class="form-inline text-center">
            <button type="button" (click)="submitjiagongfee()" class="btn btn-primary btn-large">确定</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>


<!--  销售价格调整的弹窗 -->
<!-- <div class="modal" bsModal #priceDialog="bs-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-xs">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" aria-label="Close" (click)="pricehideDialog(sprice['tprice'])">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title">销售价格调整</h4>
      </div>
      <div class="modal-body">
        <div class="panel panel-default">
          <div class="panel-body">
            <form #priceForm="ngForm">
              <div class="form-group mb fieldsetdnn col-sm-12">
                <label class="col-sm-3 control-label">销售价格</label>
                <div class="col-sm-9">
                  <input type="number" [(ngModel)]="sprice['tprice']" name="price" class="form-control" placeholder="请输入要调整的价格" required ng-pattern="/^([0-9]+|[0-9]{1,3}(,[0-9]{3})*)(.[0-9]{1,2})?$/"
                  />
                  <span *ngIf="priceForm.controls['price']?.errors?.pattern && priceForm.controls['price']?.dirty || priceForm.controls['price']?.touched"
                    class="text-danger">价格不能为负数且只能输入两位小数</span>
                </div>
              </div>
            </form>
          </div>
        </div>

      </div>
      <div class="modal-footer">
        <div class="form-inline text-center">
          <div class="form-inline text-center">
            <button type="button" (click)="pricehideDialog(sprice['tprice'])" class="btn btn-primary btn-large">确定</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div> -->

<div class="modal" bsModal #priceDialog="bs-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <button class="close" type="button" aria-label="Close" (click)="pricehideDialog()">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title pull-left">价格/费用修改</h4>
      </div>
      <div class="modal-body">
        <div class="panel panel-default">
          <div class="panel-body">

            <div class="row">
              <div class="col-md-3 col-sm-3  text-center">
                <label class="col-sm-12 control-label form-control-static">销售单价</label>
              </div>
              <div class="col-md-1 col-sm-1  text-center">
                <label class="col-sm-12 control-label">-</label>
              </div>
              <div class="col-md-2 col-sm-2  text-center">
                <label class="col-sm-12 control-label form-control-static">考核单价</label>
              </div>
              <div class="col-md-1 col-sm-1  text-center">
                <label class="col-sm-12 control-label">-</label>
              </div>
              <div class="col-md-2 col-sm-2  text-center">
                <label class="col-sm-12 control-label form-control-static">费用合计单价</label>
              </div>
              <div class="col-md-1 col-sm-1 text-center">
                <label class="col-sm-12 control-label">=</label>
              </div>
              <div class="col-md-2 col-sm-2 text-center">
                <label class="col-sm-12 control-label form-control-static">预估毛利</label>
              </div>
            </div>

            <div class="row">
              <div class="col-md-3 col-sm-3 text-center">
                <input style="text-align:center" [(ngModel)]="salepricemodel['pertprice']" class="form-control"
                  placeholder="请输入销售价格" required [disabled]="businessorder['status']===9">
              </div>
              <div class="col-md-1 col-sm-1  text-center">
                -
              </div>
              <div class="col-md-2 col-sm-2 text-center">
                <input style="text-align:center" [(ngModel)]="salepricemodel['price']" class="form-control"
                  placeholder="请输入内部结算价" required [disabled]="businessorder['status']!==9">
              </div>
              <div class="col-md-1 col-sm-1 text-center">
                -
              </div>
              <div class="col-md-2 col-sm-2 text-center">
                {{diyfeeHeji}}
              </div>
              <div class="col-md-1 col-sm-1 text-center">
                =
              </div>
              <div class="col-md-2 col-sm-2 text-center">
                {{(salepricemodel['pertprice'] - salepricemodel['price'] - diyfeeHeji )| number : '1.2-2'}}
              </div>
            </div>

            <div class="form-group mb fieldsetdnn col-sm-12 col-md-12"></div>

            <div class="row">
              <div class="col-sm-3 text-center">
                <label class="col-sm-12 control-label form-control-static">费用类型</label>
              </div>
              <div class="col-sm-3 text-center">
                <label class="col-sm-12 control-label form-control-static">单价</label>
              </div>
              <div class="col-sm-3 text-center">
                <label class="col-sm-12 control-label form-control-static">备注</label>
              </div>
              <div class="col-sm-3 text-center">
                <label class="col-sm-12 control-label form-control-static">
                  <span *ngIf="!isshowInput" class="label label-info" (click)="showInput()">插入费用</span>
                  <span *ngIf="isshowInput" class="label label-info" (click)="showInput()">取消插入</span>
                </label>
              </div>
            </div>

            <div class="row" *ngIf="isshowInput">
              <div class="col-sm-3">
                <p-dropdown [options]="feetypes" [(ngModel)]="feemodel['feetype']" placeholder="选择费用类型"
                  [style]="{'width': 'calc(100% - 30px)','margin': '0 15px'}">
                </p-dropdown>
              </div>
              <div class="col-sm-3">
                <input style="width:calc(100% - 30px); margin: 0 15px" class="form-control"
                  [(ngModel)]="feemodel['price']" placeholder="请输入费用单价" required>
              </div>
              <div class="col-sm-3">
                <input style="width:calc(100% - 30px); margin: 0 15px" class="form-control"
                  [(ngModel)]="feemodel['beizhu']" placeholder="请输入备注" required>
              </div>
              <div class="col-sm-3 text-center">
                <button type="button" (click)="addyugufeetodb()" class="btn btn-primary btn-large">添加费用</button>
              </div>
            </div>

            <div class="row fieldsetdnn" *ngFor="let item of lines">
              <div class="col-sm-3 text-center">
                <span>{{item.feetype|feetype}}</span>
              </div>
              <div class="col-sm-3 text-center">
                <span>{{item.feeprice}}</span>
              </div>
              <div class="col-sm-3 text-center">
                <span>{{item.beizhu}}</span>
              </div>
              <div class="col-sm-3 text-center">
                <span style="padding-left: 80px" (click)="delorderfeeindb(item.id,item.feeprice)">
                  <a>删除</a>
                </span>
              </div>
            </div>

          </div>
        </div>
      </div>
      <div class="modal-footer">
        <div class="form-inline text-center">
          <!-- <button type="button" (click)="addyugufeetodb()" class="btn btn-primary btn-large">添加费用</button> -->
          <button type="button" (click)="modifysaleprice()" class="btn btn-primary btn-large">提交修改</button>
        </div>
      </div>

    </div>
  </div>
</div>

<!--  添加运费的弹窗 -->
<div class="modal" bsModal #addyunfee="bs-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-xs">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" aria-label="Close" (click)="addyunfeehide()">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title">添加运费</h4>
      </div>
      <div class="modal-body">
        <div class="panel panel-default">
          <div class="panel-body">
            <div class="form-group mb fieldsetdnn col-sm-12">
              <label class="col-sm-3 control-label">运费单价</label>
              <div class="col-sm-9">
                <input type="number" [(ngModel)]="yunfeeModel['perprice']" name="perprice" class="form-control"
                  placeholder="请输入运费单价" (blur)="calctprice()" required />
              </div>
            </div>
            <div class="form-group mb fieldsetdnn col-sm-12">
              <label class="col-sm-3 control-label">运费总价</label>
              <div class="col-sm-9">
                <input type="number" [(ngModel)]="yunfeeModel['tprice']" name="price" class="form-control"
                  placeholder="请输入运费单价" (blur)="calcperprice()" required />
              </div>
            </div>
          </div>
        </div>

      </div>
      <div class="modal-footer">
        <div class="form-inline text-center">
          <div class="form-inline text-center">
            <button type="button" (click)="selectNull()" class="btn btn-info btn-large">重填</button>
            <button type="button" (click)="yunfeeok()" class="btn btn-primary btn-large">提交</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<!--  支付订单的弹窗 -->
<div class="modal" bsModal #payorder="bs-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
  aria-hidden="true">

  <div class="modal-dialog modal-xs">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" aria-label="Close" (click)="payorderhide()">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title">支付</h4>
      </div>
      <div class="modal-body">
        <div class="panel panel-default">
          <div class="panel-body">
            <div class="form-group mb fieldsetdnn col-sm-12">
              <label class="col-sm-3 control-label">客户余额：</label>
              <div class="col-sm-9">
                ￥{{msg['currentmoney']}}
              </div>
            </div>
            <div class="form-group mb fieldsetdnn col-sm-12">
              <label class="col-sm-3 control-label">应付钱款：</label>
              <div class="col-sm-9">
                ￥{{msg['paymoney']}}
              </div>
            </div>
            <div class="form-group mb fieldsetdnn col-sm-12">
              <label class="col-sm-3 control-label">验证码：</label>
              <div class="col-sm-9">
                <div class="input-group">
                  <input type="text" [(ngModel)]="msg['code']" class="form-control" [maxlength]="6" placeholder="请输入验证码"
                    required />
                  <span class="input-group-btn">
                    <button type="button" class="btn btn-default" (click)="getpaycode()" [disabled]="msg['flag']">
                      <i class="fa">{{msg['name']}}</i>
                    </button>
                  </span>
                </div>
              </div>
            </div>
          </div>
        </div>

      </div>
      <div class="modal-footer">
        <div class="form-inline text-center">
          <div class="form-inline text-center">
            <button type="button" (click)="pay()" class="btn btn-info btn-large" [disabled]="msg['payflag']">付款</button>
            <button type="button" (click)="arrearspayapply()" class="btn btn-primary btn-large"
              [disabled]="msg['arrearsflag']">欠款支付申请</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- 欠款申请 -->
<div class="modal" bsModal #arrearspayDialog="bs-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" aria-label="Close" (click)="arrearspayhide()">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title">欠款申请</h4>
      </div>
      <div class="modal-body">
        <div class="panel panel-default">
          <div class="panel-body">
            <div class="form-group mb fieldsetdnn col-sm-12">
              <label class="col-sm-3 control-label">欠款金额：</label>
              <div class="col-sm-9">
                ￥{{overdraft['tjine']}}
              </div>
            </div>
            <div class="form-group mb fieldsetdnn col-sm-12">
              <label class="col-sm-3 control-label">还款日期：</label>
              <div class="col-sm-9 wiskind-calendar">
                <p-calendar [(ngModel)]="yedate" placeholder="还款日期" [minDate]="minDate"></p-calendar>
              </div>
            </div>
            <div class="form-group mb fieldsetdnn col-sm-12">
              <label class="col-sm-3 control-label">货物名称：</label>
              <div class="col-sm-9">
                <input type="text" class="form-control" [(ngModel)]="overdraft['goodsmsg']" />
              </div>
            </div>
            <div class="form-group mb fieldsetdnn col-sm-12">
              <label class="col-sm-3 control-label">欠款天数：</label>
              <div class="col-sm-9">
                <input type="number" class="form-control" [(ngModel)]="overdraft['days']" />
              </div>
            </div>
            <div class="form-group mb fieldsetdnn col-sm-12">
              <label class="col-sm-3 control-label">欠款原因：</label>
              <div class="col-sm-9">
                <input type="text" class="form-control" [(ngModel)]="overdraft['reason']" />
              </div>
            </div>
            <div *ngIf="haszhiyajin" class="form-group mb fieldsetdnn col-sm-12">
              <label class="col-sm-3 control-label">引入质押金总金额：</label>
              <div class="col-sm-9">
                <input disabled  type="text" class="form-control" [(ngModel)]="overdraft['tzhiyajinjine']" />
              </div>
            </div>

            <div *ngIf="haszhiyajin" class="row">
              <div class="col-sm-3 text-center">
                <label class="col-sm-12 control-label form-control-static">质押公司</label>
              </div>
              <div class="col-sm-2 text-center">
                <label class="col-sm-12 control-label form-control-static">质押金金额</label>
              </div>
              <div class="col-sm-2 text-center">
                <label class="col-sm-12 control-label form-control-static">可引用金额</label>
              </div>
              <div class="col-sm-3 text-center">
                <label class="col-sm-12 control-label form-control-static">本次引用金额</label>
              </div>
              <div class="col-sm-2 text-center">
                <label class="col-sm-12 control-label form-control-static">操作</label>
              </div>
            </div>

            <div class="row fieldsetdnn" *ngFor="let item of zhiyajins">
              <div class="col-sm-3 text-center">
                <span>
                  {{item.shoukuancustomer}}
                </span>
              </div>
              <div class="col-sm-2 text-center">
                <span>{{item.jine}}</span>
              </div>
              <div class="col-sm-2 text-center">
                <span>{{item.weiimpjine}}</span>
              </div>

              <div *ngIf="item.isshowzhiyajininput" class="col-sm-3 text-center">
                <span (click)="showeditdialog(item.id)"> <a>填  充</a></span>
              </div>
              <div *ngIf="!item.isshowzhiyajininput" class="col-sm-3 text-center">
                <span>{{item.zhiyajinimpjine}}</span>
              </div>

              <div class="col-sm-2 text-center">
                <span *ngIf="!item.isshowzhiyajininput" style="padding-left: 40px" (click)="modifyzhiyajin(item.id)">
                  <a>修改</a>
                </span>
              </div>
            </div>

          </div>
        </div>
      </div>
      <div class="modal-footer">
        <div class="form-inline text-center">
          <div class="form-inline text-center">
            <button type="button" (click)="submitapply()" class="btn btn-info btn-large">提交申请</button>
            <button *ngIf="haszhiyajin" type="button" (click)="zhiyajinapply()" class="btn btn-info btn-large">质押金欠款</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<!--  添加引用质押金额的弹窗 -->
<div class="modal" bsModal #zhiyajinusejineeditor="bs-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-xs">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" aria-label="Close" (click)="closeeditdialog()">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title">引入质押金额</h4>
      </div>
      <div class="modal-body">
        <div class="panel panel-default">
          <div class="panel-body">

            <div class="form-group mb fieldsetdnn col-sm-12">
              <label class="col-sm-3 control-label">质押金引用金额</label>
              <div class="col-sm-9">
                <input type="number"  name="perprice" class="form-control" [(ngModel)] = "zhiyajinimpjine"
                  placeholder="请输入引用金额"  required />
              </div>
            </div>
            
          </div>
        </div>

      </div>
      <div class="modal-footer">
        <div class="form-inline text-center">
          <div class="form-inline text-center">
            <button type="button" (click)="usezhiyajin()" class="btn btn-primary btn-large">添加</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- 配款弹窗 -->
<div class="modal" bsModal #allocationModel="bs-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-xs">
    <div class="modal-content">
      <div class="modal-header">
        <button class="close" type="button" aria-label="Close" (click)="closeallocationdialog()">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title">添加配款</h4>
      </div>
      <div class="modal-body">
        <div class="panel panel-default">
          <div class="panel-body">

            <div class="form-group mb fieldsetdnn row">
              <label class="col-sm-4 control-label">
                <span style="float: right;">账户余额：</span>
              </label>
              <div class="col-sm-8">
                {{curyue}}
              </div>
            </div>
            <div class="form-group mb fieldsetdnn row">
              <label class="col-sm-4 control-label">
                <span style="float: right;">剩余需配款金额：</span>
              </label>
              <div class="col-sm-8">
                {{xuyue}}
              </div>
            </div>
            <div class="form-group mb fieldsetdnn row">
              <label class="col-sm-4 control-label">
                <span style="float: right;">实付货款：</span>
              </label>
              <div class="col-sm-8">
                <input type="number" [(ngModel)]="allocation['jine']" class="form-control" placeholder="请输入实付货款"
                  required>
              </div>
            </div>

          </div>
        </div>
      </div>
      <div class="form-inline text-center">
        <button type="button" (click)="addallocation()" class="btn btn-primary btn-large">添加</button>
      </div>
    </div>
  </div>
</div>
<!--释放实付配款-->
<div class="modal" bsModal #shifangallocationModel="bs-modal" tabindex="-1" role="dialog"
  aria-labelledby="mySmallModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-xs">
    <div class="modal-content">
      <div class="modal-header">
        <button class="close" type="button" aria-label="Close" (click)="closeshifangallocationdialog()">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title">释放货款</h4>
      </div>
      <div class="modal-body">
        <div class="panel panel-default">
          <div class="panel-body">

            <div class="form-group mb fieldsetdnn row">
              <label class="col-sm-3 control-label">
                <span style="float: right;">实付货款：</span>
              </label>
              <div class="col-sm-9">
                {{businessorder['allocation']}}
              </div>
            </div>
            <div class="form-group mb fieldsetdnn row">
              <label class="col-sm-3 control-label">
                <span style="float: right;">释放货款：</span>
              </label>
              <div class="col-sm-9">
                <input [(ngModel)]="allocation['jine']" class="form-control" placeholder="请输入释放定金金额" required>
              </div>
            </div>
            <div class="form-group mb fieldsetdnn row">
              <label class="col-sm-3 control-label">
                <span style="float: right;">释放原因：</span>
              </label>
              <div class="col-sm-9">
                <input [(ngModel)]="allocation['reason']" class="form-control" placeholder="请输入释放配款原因" required>
              </div>
            </div>

          </div>
        </div>
      </div>
      <div class="form-inline text-center">
        <button type="button" (click)="shifangAllocation()" class="btn btn-primary btn-large">释放</button>
      </div>
    </div>
  </div>
</div>
<div class="modal" bsModal #zhibaoshuModel="bs-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-xs">
    <div class="modal-content">
      <div class="modal-header">
        <button class="close" type="button" aria-label="Close" (click)="closezhibaoshudialog()">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title">查看质保书</h4>
      </div>
      <div class="modal-body">
        <table class="table table-striped" [mfData]="singleData" #mf="mfDataTable" [mfRowsOnPage]="100">
          <tbody>
            <tr *ngFor="let item of mf.data;let i = index;">
              <td style="width:5%;">
                <label style="width:100%;">
                  <div class="checkbox c-checkbox" style="text-align: center;" style="width:100%;">
                    <input type="checkbox" [(ngModel)]="item.checked" (ngModelChange)="checkboxchange($event)"><span
                      class="fa fa-check" style="margin-left: 15px;"></span>
                  </div>
                </label>
              </td>
              <td class="row" style="width:95%;">
                <div class=" col-lg-4 col-md-4 col-sm-6 form-control-static">
                  <label>序号：</label> {{i + 1}}
                </div>
                <div class=" col-lg-4 col-md-4 col-sm-6 form-control-static">
                  <label>资源号：</label> {{item.grno}}
                </div>
                <div class=" col-lg-4 col-md-4 col-sm-6 form-control-static">
                  <label>查看质保书：</label> <a href={{item.url}} target="_blank">查看</a>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <div class="form-inline text-center" *ngIf="singleData.length">
        <button type="button" class="btn btn-info btn-bloc" (click)="allcheck()">全选</button>
        <button type="button" class="btn btn-info btn-bloc" (click)="alldownload()">一键下载</button>
      </div>
    </div>
  </div>
</div>

<!-- 修改主表信息 -->
<div class="modal" bsModal #mainmodifydialog="bs-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-xs">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" aria-label="Close" (click)="closemaindialog()">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title">修改</h4>
      </div>
      <div class="modal-body">
        <div class="panel panel-default">
          <div class="panel-body">
            <div class="form-group mb fieldsetdnn row">
              <label class="col-sm-3 control-label">订单类型</label>
              <div class="col-sm-9">
                <label class="radio-inline c-radio">
                  <input type="radio" name="isself-radio2" [value]="true" [(ngModel)]="editorder['isself']" />
                  <span class="fa fa-circle"></span>机构自销
                </label>
                <label class="radio-inline c-radio">
                  <input type="radio" name="isself-radio2" [value]="false" [(ngModel)]="editorder['isself']" />
                  <span class="fa fa-circle"></span>机构代销
                </label>
              </div>
            </div>
            <div class="form-group mb fieldsetdnn row">
              <label class="col-sm-3 control-label">配送方式:</label>
              <div class="col-sm-9">
                <label class="radio-inline c-radio">
                  <input id="inlineradio1" type="radio" name="i-radio" [value]="0" [(ngModel)]="editorder['type']" />
                  <span class="fa fa-circle"></span>自提
                </label>
                <label class="radio-inline c-radio">
                  <input id="inlineradio2" type="radio" name="i-radio" [value]="1" [(ngModel)]="editorder['type']"
                    (ngModelChange)="getAddr()" />
                  <span class="fa fa-circle"></span>代运
                </label>
                <label class="radio-inline c-radio">
                  <input id="inlineradio3" type="radio" name="i-radio" [value]="2" [(ngModel)]="editorder['type']" />
                  <span class="fa fa-circle"></span>转货
                </label>
              </div>
            </div>
            <div class="form-group mb fieldsetdnn row">
              <label class="col-sm-3 control-label">收货地址:</label>
              <div class="col-sm-7">
                <p-dropdown [options]="addrs" [(ngModel)]="editorder['addrid']" [style]="{'width':'100%'}"
                  [filter]="true" filterBy="label,value.name">
                </p-dropdown>
              </div>
              <div class="col-sm-2">
                <span class="input-group-btn">
                  <button type="button" class="btn btn-default" (click)="addAddrDialog()">
                    <i class="fa fa-plus"></i>
                  </button>
                </span>
              </div>
            </div>
          </div>
        </div>
        <div class="form-inline text-center">
          <button type="button" (click)="modifymain()" class="btn btn-primary btn-large">修改</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!--添加地址弹窗-->
<div class="modal" bsModal #addrdialog="bs-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-md">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" aria-label="Close" (click)="addrdialogclose()">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title">添加地址</h4>
      </div>
      <div class="modal-body">
        <div class="panel panel-default">
          <div class="panel-body">
            <div class="form-group mb fieldsetdnn col-sm-12 ">
              <label class="col-sm-3 control-label">详细地址：</label>
              <div class="col-sm-9">
                <!-- <input type="text" placeholder="请输入详细地址" [(ngModel)]="addr['detail']" class="form-control" required /> -->
                <p-autoComplete placeholder="请输入详细地址" name="addr" [(ngModel)]="addr['detail']" [suggestions]="results"   
                  (completeMethod)="searchplace($event)" [style]="{'width':'85%'}" [inputStyle]="{'width':'85%'}" field="name" 
                  dataKey="id" [dropdown]="false">
                 </p-autoComplete>
              </div>
            </div>
            <div class="form-group mb fieldsetdnn col-sm-12 ">
              <label class="col-sm-3 control-label">联系人：</label>
              <div class="col-sm-9">
                <input type="text" placeholder="请输入联系人" [(ngModel)]="addr['lianxiren']" class="form-control" required />
              </div>
            </div>
            <div class="form-group mb fieldsetdnn col-sm-12 ">
              <label class="col-sm-3 control-label">联系方式：</label>
              <div class="col-sm-9">
                <input type="text" placeholder="请输入联系方式" [(ngModel)]="addr['phone']" class="form-control" required />
              </div>
            </div>
          </div>
        </div>
        <div class="form-inline text-center">
          <button type="button" (click)="addAddr()" class="btn btn-primary btn-large">添加</button>
        </div>
      </div>
    </div>
  </div>
</div>
<!--合同变更原因填写-->
<div class="modal" bsModal #qhchangetijiaoModel="bs-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-xs">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" aria-label="Close" (click)="qhchangetijiaoclose()">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title">合同变更提交备注</h4>
      </div>
      <div class="modal-body">
        <p-messages *ngIf="!validQihuochangedet.length" [(value)]="msgs" [closable]="false"></p-messages>
        <div class="panel panel-default">
          <div class="panel-body">
            <div class="form-group mb fieldsetdnn row">
              <label class="col-sm-3 control-label">备注:</label>
              <div class="col-sm-9">
                <input type="text" name="qhchangetijiaobeizhu" [(ngModel)]="qhchangetijiaobeizhu" class="form-control"
                  placeholder="请输入备注" />
              </div>
            </div>
            <p style="color:red;font-size: 10px;">*修改考核单价审批流程：业务员-机构负责人-资源外务</p>
          </div>
        </div>
        <div class="form-inline text-center">
          <button type="button" (click)="qhchangetijiao()" class="btn btn-primary btn-large">确认</button>
        </div>
      </div>
    </div>
  </div>
</div>
  <!--添加弹窗-->
  <div class="modal" bsModal #addqualityModal="bs-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-md">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" aria-label="Close" (click)="hideaddModal()">
            <span aria-hidden="true">&times;</span>
          </button>
          <h4 class="modal-title">添加</h4>
        </div>
        <div class="modal-body">
          <div class="form-group mb fieldsetdnn col-sm-12 col-md-12">
            <label class="col-sm-3 control-label">是否需要在本订单中处理前期已提报尚未处理的质量异议</label>
            <div class="col-sm-9">
              <label class="radio-inline c-radio">
                <input id="inlineradio1" type="radio" name="ischuliquality-radio" [value]="1" [(ngModel)]="qualityModel['ischuliquality']" />
                <span class="fa fa-circle"></span>是
              </label>
              <label class="radio-inline c-radio">
                <input id="inlineradio2" type="radio" name="ischuliquality-radio" [value]="0" [(ngModel)]="qualityModel['ischuliquality']" />
                <span class="fa fa-circle"></span>否
              </label>
              <span style="color: red;">*必选项，如果选择是，则提交审核后触发审批</span>
            </div>
          </div>
          <div *ngIf="qualityModel['ischuliquality'] === 1" class="form-group mb fieldsetdnn row">
            <label class="col-sm-3 control-label required">处理类型</label>
            <div class="col-sm-9">
              <p-dropdown [options]="saletypes" placeholder="选择处理类型" [(ngModel)]="qualityModel['saletype']"  [style]="{'width': '100%'}">
              </p-dropdown>
            </div>
          </div>
          <div *ngIf="qualityModel['ischuliquality'] === 1" class="form-group mb fieldsetdnn col-sm-12 col-md-12">
            <label class="col-sm-3 control-label">说明</label>
            <div class="col-sm-9">
              <input type="text" [(ngModel)]="qualityModel['salebeizhu']" class="form-control" />
            </div>
          </div>
          <div *ngIf="qualityModel['ischuliquality'] === 1" class="form-group mb fieldsetdnn col-sm-12 col-md-12">
            <label class="col-sm-3 control-label">赔付金额</label>
            <div class="col-sm-9">
              <input type="number" [(ngModel)]="qualityModel['salejine']" class="form-control" />
            </div>
          </div>
          <div class="form-inline text-center">
            <button *ngIf="qualityModel['ischuliquality'] === 1" type="button" (click)="choice()" class="btn btn-primary btn-large">选择质量异议</button>
            <button *ngIf="qualityModel['ischuliquality'] !== 1" type="button" (click)="addupdate()" class="btn btn-primary btn-large">提交</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!--  选择模板的弹窗 -->
<div class="modal" bsModal #ordermodalchange="bs-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
aria-hidden="true">
  <div class="modal-dialog modal-xs">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" aria-label="Close" (click)="hideordermodalchange()">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title">模板选择</h4>
      </div>
      <div class="modal-body">
        <div class="panel panel-default">
          <div class="panel-body">
            <div class="col-sm-9">
              <p-dropdown [options]="ordermodal" placeholder="选择模板" [(ngModel)]="changeordermodal['ordermodal']"  [style]="{'width': '100%'}">
              </p-dropdown>
            </div>
            <div class="form-inline text-center">
              <button type="button" (click)="reload()" class="btn btn-primary btn-large">确定打印</button>
            </div>
       <!--      <div class="row fieldsetdnn">
              &emsp;&emsp;&emsp;&emsp;&emsp;
              <button  type="button" (click)="makepdf()" class="btn btn-info btn-large">默认模板</button>
              &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;
              <button  type="button"  (click)="makepdf()" class=" btn btn-info btn-large">老模板</button>              
            </div> -->
          </div>
        </div>
      </div>
    </div> 
  </div>
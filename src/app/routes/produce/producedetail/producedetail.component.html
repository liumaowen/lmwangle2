<div class="content-heading">
  <em class="fa fa-book"></em> 加工登记单
  <div class="pull-right">
    <button type="button" *ngIf="!produce['isv']" (click)="removeById(produce['id'])"
      class="btn btn-sm margin-top-bottom-25" style="background-color:red;border-color:red;color:#ffffff;">删除</button>
    <button type="button" *ngIf="!produce['isv']" (click)="removeDet()"
      class="btn btn-sm margin-top-bottom-25" style="background-color:red;border-color:red;color:#ffffff;">批量删除明细</button>
    <button type="button" class="btn btn-info btn-bloc" (click)="produceUploader()">上传验收单</button>
    <!-- 加工单位为邯郸市维实供应链服务有限公司，可点击 -->
    <button *ngIf="!produce['isv'] && (produce['producemode'] === 1 || produce['producemode'] === 3)" type="button" (click)="showproducefeedialog()"
      class="btn btn-info btn-sm margin-top-bottom-25">费用添加</button>
    <button *ngIf="produce['producemode'] !== 1 && produce['producemode'] !== 3" type="button" (click)="showFproductfeedialog()"
      class="btn btn-info btn-sm margin-top-bottom-25">成品费用添加</button>
    <button *ngIf="showbutton['imp']" type="button" (click)="basematerialImp()"
      class="btn btn-info btn-sm margin-top-bottom-25">基料引入</button>
    <button *ngIf="showbutton['check']" type="button" (click)="checkAndruku()"
      class="btn btn-info btn-sm margin-top-bottom-25">验收</button>
    <button *ngIf="!showbutton['check']" type="button" (click)="cancelCheck()"
      class="btn btn-info btn-sm margin-top-bottom-25">撤销验收</button>
    <button *ngIf="!showbutton['check']" type="button" (click)="weishizhibao()"
      class="btn btn-info btn-sm margin-top-bottom-25">生成质保书</button>
  </div>
</div>

<div class="panel panel-default wis-auto">
  <div class="row fieldsetdnn">
    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 form-control-static">加工单号:</div>
        <div class="col-md-8 col-xs-6 form-control-static">{{produce['billno']}}</div>
      </div>
    </div>
    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 control-label form-control-static">加工单位:</div>
        <div class="col-md-8 col-xs-6 form-control-static">
          {{produce['jgdw'] | customer}}
        </div>
      </div>
    </div>
    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 control-label form-control-static">客户单位:</div>
        <div class="col-md-8 col-xs-6 form-control-static">
          {{produce['buyer'] | customer}}
        </div>
      </div>
    </div>
    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 control-label form-control-static">是否验收:</div>
        <div class="col-md-8 col-xs-6 form-control-static">
          {{produce['isv'] | isTranslated}}
        </div>
      </div>
    </div>
  </div>
  <div class="row fieldsetdnn">
    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 control-label form-control-static">制单人:</div>
        <div class="col-md-8 col-xs-6 form-control-static">
          {{produce | agentuser}}
        </div>
      </div>
    </div>

    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 control-label form-control-static">下单时间:</div>
        <div class="col-md-8 col-xs-6 form-control-static">
          {{produce['cdate']}}
        </div>
      </div>
    </div>
    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 control-label form-control-static">版本号:</div>
        <div class="col-md-8 col-xs-6 form-control-static">
          {{produce['version']}}
        </div>
      </div>
    </div>
    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 control-label form-control-static">业务员:</div>
        <div class="col-md-8 col-xs-6 form-control-static">
          {{produce['saleman']?produce['saleman']['realname']:''}}
        </div>
      </div>
    </div>
  </div>
  <div class="row fieldsetdnn">
    <div class=" col-lg-3 col-md-6 ">
      <div class="row">
        <div class="col-md-4 col-xs-6 control-label form-control-static">原卷重量:</div>
        <div class="col-md-8 col-xs-6 form-control-static">
          {{produce['bmweight']}}
        </div>
      </div>
    </div>
    <div class=" col-lg-3 col-md-6">
      <div class="row">
        <div class="col-md-4 col-xs-6 control-label form-control-static">验收重量:</div>
        <div class="col-md-8 col-xs-6 form-control-static">
          {{produce['ysweight']}}
        </div>
      </div>
    </div>
    <div class=" col-lg-3 col-md-6">
      <div class="row">
        <div class="col-md-4 col-xs-6 control-label form-control-static">合同单号:</div>
        <div class="col-md-8 col-xs-6 form-control-static">
          {{produce['orderno']}}
        </div>
      </div>
    </div>
    <div class=" col-lg-3 col-md-6">
      <div class="row">
        <div class="col-md-4 col-xs-6 control-label form-control-static">加工类型:</div>
        <div class="col-md-8 col-xs-6 form-control-static">
          {{produce['producetype']==2?'虚拟':'常规'}}
        </div>
      </div>
    </div>

  </div>
  <div class="row fieldsetdnn">
    <div class=" col-lg-9 col-md-12">
      <div class="row">
        <div class="col-md-1 col-xs-3 control-label form-control-static">备注:</div>
        <div class="col-md-11 col-xs-9 form-control-static">
          <input type="text" placeholder="请输入备注" [(ngModel)]="produce['beizhu']" (blur)="modify()" class="form-control" />
        </div>
      </div>
    </div>
    <div class=" col-lg-3 col-md-12">
      <div class="row">
        <div class="col-md-4 col-xs-3 control-label form-control-static">加工模式:</div>
        <div class="col-md-8 col-xs-9 form-control-static">
          {{produce['producemode'] | producemode}}
        </div>
      </div>
    </div>

  </div>

</div>
<div class="viewpanel">
  <p-tabView [style]="{margin:'0 -20px','padding-top': '3px'}">
    <p-tabPanel header="钢卷明细"
      [headerStyle]="{'background-color': '#fff', 'border-color': '#ccc','border-bottom-color': 'rgba(0, 0, 0, 0)','margin-left': '5px'}">
      <ag-grid-angular [ngStyle]="{'height': (settings.bodyHeight - 439)+'px'}" #agGrid class="ag-blue wis-auto"
      [gridOptions]="gridOptions" style="width: calc(100% + 22px);height:100%;margin:0 -11px;margin-top:-5px;">
      </ag-grid-angular>
    </p-tabPanel>
    <p-tabPanel header="费用明细"
      [headerStyle]="{'background-color': '#fff', 'border-color': '#ccc',color: '#ddd'}">
      <ag-grid-angular [ngStyle]="{'height': (settings.bodyHeight - 439)+'px'}" #agGridq
        style="width: calc(100% + 22px);height:100%;margin:0 -11px;margin-top:-5px;" class="ag-blue"
        [gridOptions]="feegridOptions" style="width: calc(100% + 22px);height:100%;margin:0 -11px;margin-top:-5px;">
      </ag-grid-angular>
    </p-tabPanel>
  </p-tabView>
</div>


<toaster-container></toaster-container>


<!--添加余卷弹窗-->
<div class="modal" bsModal #remainModal="bs-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" aria-label="Close" (click)="hideremainImport()">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title">添加余卷</h4>
      </div>
      <form name="form1" class="form-horizontal" (ngSubmit)="addReproduct()">
        <div class="modal-body">
          <div class="panel panel-default">
            <div class="panel-body">
              <div class="form-group mb fieldsetdnn col-sm-12 col-md-6">
                <label class="col-sm-3 control-label">重量</label>
                <div class="col-sm-9">
                  <input type="text" name="weight" placeholder="请输入要改变的重量" [(ngModel)]="remainedit['weight']"
                    class="form-control" required />
                </div>
              </div>
            </div>
          </div>
          <div class="form-inline text-center">
            <button type="submit" class="btn btn-primary btn-large">添加</button>
          </div>
        </div>
      </form>
    </div>
  </div>
</div>

<!--添加边料边丝弹窗-->
<div class="modal" bsModal #bianModal="bs-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" aria-label="Close" (click)="hidebianImport()">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title">添加边丝/边料</h4>
      </div>
      <!-- <form name="form" class="form-horizontal" (ngSubmit)="addReproduct()"> -->
      <div class="modal-body">
        <div class="panel panel-default">
          <div class="panel-body">
            <div class="form-group mb fieldsetdnn col-sm-12 col-md-6">
              <label class="col-sm-3 control-label">类别</label>
              <div class="col-sm-9">
                <label class="radio-inline c-radio">
                  <input type="radio" name="typecode" value="3" [(ngModel)]="chanpin['typecode']" />
                  <span class="fa fa-circle"></span>边料
                </label>
                <label class="radio-inline c-radio">
                  <input type="radio" name="typecode" value="4" [(ngModel)]="chanpin['typecode']" />
                  <span class="fa fa-circle"></span>边丝
                </label>
              </div>
            </div>
            <div class="form-group mb fieldsetdnn col-sm-12 col-md-6">
              <label class="col-sm-3 control-label">重量</label>
              <div class="col-sm-9">
                <input type="text" placeholder="请输入要改变的重量" [(ngModel)]="chanpin['weight']" class="form-control" />
              </div>
            </div>
            <div class="form-group mb fieldsetdnn col-sm-12 col-md-6">
              <label class="col-sm-3 control-label">捆包号</label>
              <div class="col-sm-9">
                <input type="text" placeholder="请输入捆包号" [(ngModel)]="chanpin['kunbaohao']" class="form-control" />
              </div>
            </div>

            <div class="form-group mb fieldsetdnn col-sm-12 col-md-6">
              <label class="col-sm-3 control-label">宽度</label>
              <div class="col-sm-9">
                <input type="text" placeholder="请输入宽度" [(ngModel)]="chanpin['width']" class="form-control" />
              </div>
            </div>

          </div>
        </div>
        <div class="form-inline text-center">
          <button type="button" class="btn btn-primary btn-large" (click)="addBian()">添加</button>
        </div>
      </div>
      <!-- </form> -->
    </div>
  </div>
</div>
<!-- 上传验收单 -->
<div class="modal" bsModal #uploaderModel="bs-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
  aria-hidden="false">
  <div class="modal-dialog modal-xs">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" aria-label="Close" (click)="hideDialog()">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title">上传队列</h4>
      </div>
      <wisk-uploader [uploadParam]="uploadParam" [accept]="accept" (select)="uploads($event)"></wisk-uploader>
      <div class="form-inline">
      </div>
    </div>
  </div>
</div>
<!-- 邯郸加工费用添加-->
<div class="modal" bsModal #producefeeModal="bs-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-xs">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" aria-label="Close" (click)="hideproducefeedialog()">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title">加工费用添加</h4>
      </div>
      <div class="modal-body">
        <div class="panel panel-default">
          <div class="panel-body">

            <div class="form-group mb fieldsetdnn col-sm-12">
              <label class="col-sm-3 control-label">费用类型</label>
              <div class="col-sm-9">
                <p-dropdown [options]="producefeetype" [(ngModel)]="producefee['feetype']" placeholder="请选择费用类型"
                  [style]="{'width': '100%'}">
                </p-dropdown>
              </div>
            </div>
            <div class="form-group mb fieldsetdnn col-sm-12">
              <label class="col-sm-3 control-label">重量</label>
              <div class="col-sm-9">
                <input type="text" [(ngModel)]="producefee['weight']" class="form-control" [disabled]="true" />
              </div>
            </div>
            <div class="form-group mb fieldsetdnn col-sm-12">
              <label class="col-sm-3 control-label">单价</label>
              <div class="col-sm-9">
                <input type="number" [(ngModel)]="producefee['price']" class="form-control" (blur)="getjine()" />
              </div>
            </div>
            <div class="form-group mb fieldsetdnn col-sm-12">
              <label class="col-sm-3 control-label">金额</label>
              <div class="col-sm-9">
                <input type="number" [(ngModel)]="producefee['jine']" class="form-control" (blur)="getprice()" />
              </div>
            </div>
            <div class="form-group mb fieldsetdnn col-sm-12">
              <label class="col-sm-3 control-label">付款公司：</label>
              <div class="col-sm-9">
                <app-wiskinnercompany (wiskindcompany)="innercompany($event)"></app-wiskinnercompany>
              </div>
            </div>
            <div class="form-group mb fieldsetdnn col-sm-12" *ngIf="produce['producemode'] !== 1 && produce['producemode'] !== 3">
              <label class="col-sm-4 control-label">记账方向:</label>
              <div class="col-sm-8">
                <label class="radio-inline c-radio">
                  <input id="inlineradio1" type="radio" name="i-radio" value="1"
                    [(ngModel)]="producefee['accountdirection']" />
                  <span class="fa fa-circle"></span>采购</label>
                <label class="radio-inline c-radio">
                  <input id="inlineradio2" type="radio" name="i-radio" value="2"
                    [(ngModel)]="producefee['accountdirection']" />
                  <span class="fa fa-circle"></span>销售</label>
              </div>
            </div>
            <div class="form-group mb fieldsetdnn col-sm-12">
              <label class="col-sm-3 control-label">备注</label>
              <div class="col-sm-9">
                <input type="text" [(ngModel)]="producefee['beizhu']" class="form-control" />
              </div>
            </div>

          </div>
        </div>

      </div>
      <div class="modal-footer">
        <div class="form-inline text-center">
          <div class="form-inline text-center">
            <button type="button" *ngIf="produce['producemode'] === 1 || produce['producemode'] === 3" (click)="createproduceFee()" class="btn btn-primary btn-large">添加</button>
            <button type="button" *ngIf="produce['producemode'] !== 1 && produce['producemode'] !== 3" (click)="createFproduceFee()" class="btn btn-primary btn-large">确定</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<!--添加修改弹窗-->
<div class="modal" bsModal #createModal="bs-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" aria-label="Close" (click)="hidecreatemodal()">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title">修改</h4>
      </div>
      <div class="modal-body">
        <div class="panel panel-default">
          <div class="panel-body">
            <div class="form-group mb fieldsetdnn col-sm-12 col-md-6">
              <label class="col-sm-3 control-label">单价</label>
              <div class="col-sm-9">
                <input type="number" placeholder="请输入单价" class="form-control" [(ngModel)]="producefee2['price']" (blur)="getjine1()" />
              </div>
            </div>
            <div class="form-group mb fieldsetdnn col-sm-12 col-md-6">
              <label class="col-sm-3 control-label">金额</label>
              <div class="col-sm-9">
                <input type="number" placeholder="请输入金额" class="form-control" [(ngModel)]="producefee2['jine']" (blur)="getprice1()" />
              </div>
            </div>
          </div>
        </div>
        <div class="form-inline text-center">
          <button type="button" (click)="modifyok()" class="btn btn-primary btn-large">修改</button>
        </div>
      </div>
    </div>
  </div>
</div>
